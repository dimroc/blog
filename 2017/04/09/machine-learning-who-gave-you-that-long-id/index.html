<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!--iPhone preview -->
  <meta property="og:title" content="Machine Learning where your long ID comes from" />
  <meta property="og:image" content="/public/images/machine-learning-ids/firstDigitThreePolicies.png" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Machine Learning where your long ID comes from &middot; dimroc
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/tagging.css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Javascript -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script src="/public/javascript/detectmobilebrowser.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <meta name="google-site-verification" content="KFJOcbe4F4sAQcx11yd_6hmxu0DVdy6ZgI7y6TFK8VU" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43559997-2', 'auto');
  ga('send', 'pageview');
</script>

</head>


  <body class="sidebar-overlay">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Blog</a>
    <a class="sidebar-nav-item" href="https://github.com/dimroc">GitHub</a>
    <a class="sidebar-nav-item" href="https://experiments.dimroc.com">Experiments</a>

    

    
    
      
        
      
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://twitter.com/dimroc">@dimroc</a>
  </nav>

  <div class="sidebar-item">
    <p>Tags</p>
  </div>

  <nav class="sidebar-nav">
    
    
      <a class="sidebar-nav-item" href=/tag/webgl/>webgl</a>
    
      <a class="sidebar-nav-item" href=/tag/javascript/>javascript</a>
    
      <a class="sidebar-nav-item" href=/tag/twitter/>twitter</a>
    
      <a class="sidebar-nav-item" href=/tag/nyc/>nyc</a>
    
      <a class="sidebar-nav-item" href=/tag/elasticsearch/>elasticsearch</a>
    
      <a class="sidebar-nav-item" href=/tag/ios/>ios</a>
    
      <a class="sidebar-nav-item" href=/tag/ruby/>ruby</a>
    
      <a class="sidebar-nav-item" href=/tag/elixir/>elixir</a>
    
      <a class="sidebar-nav-item" href=/tag/golang/>golang</a>
    
      <a class="sidebar-nav-item" href=/tag/scala/>scala</a>
    
      <a class="sidebar-nav-item" href=/tag/etl/>etl</a>
    
      <a class="sidebar-nav-item" href=/tag/swift/>swift</a>
    
      <a class="sidebar-nav-item" href=/tag/testing/>testing</a>
    
      <a class="sidebar-nav-item" href=/tag/rails/>rails</a>
    
      <a class="sidebar-nav-item" href=/tag/python/>python</a>
    
      <a class="sidebar-nav-item" href=/tag/business/>business</a>
    
      <a class="sidebar-nav-item" href=/tag/go/>go</a>
    
      <a class="sidebar-nav-item" href=/tag/docker/>docker</a>
    
      <a class="sidebar-nav-item" href=/tag/react/>react</a>
    
      <a class="sidebar-nav-item" href=/tag/tutum/>tutum</a>
    
      <a class="sidebar-nav-item" href=/tag/aws/>aws</a>
    
      <a class="sidebar-nav-item" href=/tag/machine-learning/>machine-learning</a>
    
      <a class="sidebar-nav-item" href=/tag/angular/>angular</a>
    
      <a class="sidebar-nav-item" href=/tag/finance/>finance</a>
    
      <a class="sidebar-nav-item" href=/tag/books/>books</a>
    
      <a class="sidebar-nav-item" href=/tag/octave/>octave</a>
    
      <a class="sidebar-nav-item" href=/tag/kubernetes/>kubernetes</a>
    
      <a class="sidebar-nav-item" href=/tag/coreml/>coreml</a>
    
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2023. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">dimroc</a>
            <small>blog</small>
            <span class="masthead-links">
              <a href="https://experiments.dimroc.com" title="Experiments">See Experiments</a>
            </span>
          </h2>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Machine Learning where your long ID comes from</h1>
  <span class="post-date">09 Apr 2017</span>
  <span class="post-comments"><a href="#disqus_thread"></a></span>
  <p><em>This article talks about a solution that involved sensitive information.
As a result, all the names and numbers have been replaced with bogus
information.  The concepts are still relevant and applicable.</em></p>

<p>Everyone has an insurance number, and no one knows their actual insurance policy.
Is it car or life insurance? Is it Platinum Shield Standard or Platinum Shield
Plus NY? Bronze or Silver plan?</p>

<p>A client wanted to know and I was fresh out of my <a href="https://www.coursera.org/learn/machine-learning">Machine Learing Class by
Andrew Ng of Stanford and Coursera</a>.
But this had to be low maintenance, so mathematical python code was going to be a stretch.
In came <a href="https://aws.amazon.com/machine-learning/">AWS Machine Learning</a> to save the day.</p>

<h2 id="why-not-just-use-regex">Why not just use Regex?</h2>

<ul>
  <li>Regex might not exist for that particular provider</li>
  <li>Cannot learn and improve over time like a machine learning model</li>
  <li>Still unmanageable working with tens if not hundreds of providers
as opposed to one <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/multiclass-classification.html">Multiclass Classification Model</a></li>
</ul>

<h2 id="how-do-we-machine-learn-a-string">How do we machine learn a string?</h2>

<p><strong>WXY5678</strong> isn’t the greatest thing to plot, so how do you draw a decision
boundary around it?</p>

<p>I opted to make each digit a dimension, and simply plot that one character in
its own plane. Then rely on the multidimensional power of machine learning
to intuit who the originator was.</p>

<p>Therefore <strong>WXY5678</strong> becomes an array of seven features, a seven dimensional vector:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[W,X,Y,5,6,7,8]
</code></pre></div></div>

<p>We can’t plot <strong>W</strong> though can we? Yes we can, by translating [0-9A-Z] to be
a number from 0-35, essentially using our numbers as base 36.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[32,33,34,5,6,7,8]
</code></pre></div></div>

<h2 id="starting-with-the-first-digit-one-dimension">Starting with the first digit: one dimension</h2>

<p><img src="/public/images/machine-learning-ids/firstDigitTwoPolicies.png" alt="First Digit - Two" />
<em><a href="https://www.gnu.org/software/octave/">Octave Plot</a> of the first digit for two policies</em></p>

<p>Here we have plotted the first digit of two policies for one thousand numbers,
and the pattern is obvious. A simple linear regression would yield the following split:</p>

<p><img src="/public/images/machine-learning-ids/firstDigitTwoPoliciesLinearRegression.png" alt="First Digit - Two" /></p>

<p>We can now confidently (&gt;90%) predict the policy just based on the first digit.
We take this concept and extrapolate it in two directions:</p>

<ol>
  <li>Add more policies, and therefore more classes (different colored dots)</li>
  <li>Add more digits, and therefore more dimensions</li>
</ol>

<h2 id="more-policies-more-classes">More policies, more classes</h2>

<p><img src="/public/images/machine-learning-ids/firstDigitThreePolicies.png" alt="First Digit - Three" /></p>

<p>The yellow bar is actually a third policy, and notice that it’s hardcoded to
one value, resulting in a point cloud so thick, it looks like a line.
Again, we can easily intuit this policy from the others with high confidence,
with just the first digit.</p>

<p>Will our luck continue as we add more policies?</p>

<p><img src="/public/images/machine-learning-ids/firstDigitManyPolicies.png" alt="First Digit - Many" /></p>

<p><strong>No.</strong></p>

<p>Above, you’ll see a plot of just eight policies among the hundred we’re trying
to classify. You can see that patterns start falling apart.</p>

<p>But don’t lose hope. We have many more digits to go, and that’ll help us draw
confident decision boundaries around certain policies. It’ll just be in
20D. Do they have glasses for that?</p>

<h2 id="more-digits-more-dimensions">More digits, more dimensions</h2>

<p>Imagine 20 features, one per digit, all collaborating to isolate the pattern.</p>

<p>Visualizing three dimensions can get trippy, so twenty plus is unrealistic.
As such, we place our trust in math and our test set that the combination of
these dimensions will yield confident answers.</p>

<p>Visualizing such high dimensions involves <a href="https://en.wikipedia.org/wiki/Dimensionality_reduction">dimensionality reduction</a>
and is not something I did for this project.</p>

<h2 id="other-features">Other Features</h2>

<p><img src="/public/images/machine-learning-ids/ParachuteInsuranceNumbersExpandedFeatureList.jpg" alt="Features Spreadsheet" /></p>

<p>Just for good measure, I added the additional features of number length and base 10.
Policy numbers vary in length based on who issued them, so just another
dimension for us to draw decision boundaries for. The base 36 number as
base 10 was an experimented that yielded little return.</p>

<h2 id="final-outcome">Final Outcome</h2>

<p><img src="/public/images/machine-learning-ids/PredictionHeatMap.jpg" alt="Heat Map" />
<em>AWS Machine Learning Evaluation</em></p>

<p>Above, you can see ten of the hundred policies plotted in a score matrix.
The blue boxes descending diagonally indicate correct predictions and show
this has been pretty successful. The F1 Score for the first row is 92% while
the accuracy (not shown) is 99.5%. Not bad!</p>

<p>The two red boxes above might give cause for concern but the mistaken predictions
all belonged to the correct company, just a different plan.
The service is tasked with showing the top three predictions, so the correct
prediction will appear second rather than first, something the service can
live with.</p>

<h3 id="policy-predictor">Policy Predictor</h3>

<p><img src="/public/images/machine-learning-ids/Parachute_Policy_Predictor.jpg" alt="Prediction Searcher" /></p>

<p>And there you have it, machine learned predictions at your fingertips.</p>

<p>Be sure to check out <a href="/2017/04/11/rake-ml-learn-aws-ml-generation-through-rake/">my post tying this into Rails and Rake for easy model
retraining with <code class="language-plaintext highlighter-rouge">rake ml:learn</code></a>.
After that, it’ll be on to TensorFlow.</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2019/12/31/books-worth-reading-2019/">
            Books Worth Reading 2019
            <small>31 Dec 2019</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/12/31/books-worth-reading-2018/">
            Books Worth Reading 2018
            <small>31 Dec 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/08/12/counting-crowds-with-coreml/">
            Moving AI from the Cloud to the Edge with Crowd Count and Apple's Core ML
            <small>12 Aug 2018</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dimroc'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'dimroc'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>


  </body>
</html>
