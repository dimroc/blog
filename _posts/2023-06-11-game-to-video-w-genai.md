---
layout: post
title: "Game to Video: Using Generative AI to Uprender Gameplay"
date: "Sun June 11 08:07:22 -0500 2023"
tags: ml games ai genai godot
---

<video autoplay controls muted loop>
  <source src="/public/game2video/fps_rendered_hstacked.mp4" type="video/mp4">
</video>

<caption>Read on for higher res videos and a how-to</caption>


## Using gameplay footage to control Stable Diffusion

Generative AI is all the rage right now. One area I'm fascinated by is [ControlNet's]() ability to control
the output of Stable Diffusion, an image generation model, using depth maps and segmentation maps. Examples
from ControlNet's site:

<div>
  <img src="/public/game2video/ControlNetDepthMap.png" width="350px" style="display: inline"/>
  <img src="/public/game2video/ControlNetSegmentationMap.png" width="350px" style="display: inline"/>
</div>

Depth Maps and Segmentation Maps can be generated by game engines, in real-time. I decided to whip up
a mini game in [Godot](), render some frames and movies, and see what uprendering gameplay could look like.

## Starting with Image Frames
Below, you'll see simple first person images of a game with untextured models, rerendered as
depth maps and segmentation maps. Scroll to the bottom for higher resolution videos.

<div style="display: flex; flex-wrap: wrap;">
  <img src="/public/game2video/fps_screenshot_regular.jpg" />
  <img src="/public/game2video/fps_screenshot_depth.jpg" width="368px" style="margin:0" />
  <img src="/public/game2video/fps_screenshot_seg.jpg"   width="368px" style="margin:0" />
</div>

### Multi-ControlNet

ControlNet takes in guiding input, like edges, depth maps, and segmentation maps to guide the generated
media. One can even use multiple controls to give better direction, like a depth map and a segmentation map.
Focusing on single frames for Multi-ControlNet as a starter, the following images were generated:

<div style="display: flex; flex-wrap: wrap;">
  <img src="/public/game2video/00003-Imagine a world where the sky is a deep purple hue and the clouds are a vibrant orange. In the center of a vast desert stands an.jpg" width="368px" style="margin:0"/>
  <img src="/public/game2video/00004-draw an old Catholic church made of gray-brown stone, a view from the inside of the temple, destroyed with broken windows and cr.png" width="368px" style="margin:0"/>
  <img src="/public/game2video/00005-modern chic futuristic royal house with gold intricate details at Pamukkale, thermal waters flowing down white travertine terrac.png" width="368px" style="margin:0"/>
  <img src="/public/game2video/00009-modern chic futuristic royal house with gold intricate details at Pamukkale, thermal waters flowing down white travertine terrac.png" width="368px" style="margin:0"/>
</div>

Taking the most promising one and creating a sequence of images to make a movie had a lot of flickering:


TODO


Incorporating [TemporalKit]() would be the next step. But we're pressed for time over here.
Instead, we turned to Runway ML's video to video.

## Upgrading to Videos with Runway ML Video to Video

Below you'll see the same first person video rendered in three different modes: untextured, depth, and segmentation.

<video src="/public/game2video/fps_hstacked.mp4" controls="true" type="video/mp4"></video>
Taking this input, we explored a few different themes and prompts:

<video src="/public/game2video/Gen-1 fps_depth_origami.mp4" controls="true" type="video/mp4"></video>
<video src="/public/game2video/Gen-1 fps_egyptian_temple.mp4" controls="true" type="video/mp4"></video>
<video src="/public/game2video/Gen-1 thunder_heaven.mp4" controls="true" type="video/mp4"></video>


## Orthogonal Camera of isometric not so successful in video

It seems many image generation models assume a sky backdrop. After searching for a bit, I found
a few promising isometric models to generate the following output. Lackluster compared to first person in my opinion.

<div style="display: flex; flex-wrap: wrap;">
  <img src="/public/game2video/ortho_w_hero_regular.jpg" width="368px"/>
  <img src="/public/game2video/ortho_segmentation.jpg" width="368px"/>
</div>

<video src="/public/game2video/Gen-1 ortho_segmentation.mp4" controls="true" type="video/mp4" width="600px"></video>
<video src="/public/game2video/Gen-1 ortho_segmentation_bad.mp4" controls="true" type="video/mp4" width="600px"></video>


## Thanks for reading this far!

Stay tuned for part 2, and drop a comment below!

# Video Dump

<video src="/public/game2video/fps_vstacked.mp4" controls="true" type="video/mp4"></video>
<video src="/public/game2video/fps_rendered_vstacked.mp4" controls="true" type="video/mp4"></video>
