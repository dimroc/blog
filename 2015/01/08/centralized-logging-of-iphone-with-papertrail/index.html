<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!--iPhone preview -->
  <meta property="og:title" content="Centralized Logging of iPhone apps with Papertrail" />
  <meta property="og:image" content="/" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Centralized Logging of iPhone apps with Papertrail &middot; dimroc
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/tagging.css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Javascript -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script src="/public/javascript/detectmobilebrowser.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <meta name="google-site-verification" content="KFJOcbe4F4sAQcx11yd_6hmxu0DVdy6ZgI7y6TFK8VU" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43559997-2', 'auto');
  ga('send', 'pageview');
</script>

</head>


  <body class="sidebar-overlay">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Blog</a>
    <a class="sidebar-nav-item" href="https://github.com/dimroc">GitHub</a>
    <a class="sidebar-nav-item" href="https://experiments.dimroc.com">Experiments</a>

    

    
    
      
        
      
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://twitter.com/dimroc">@dimroc</a>
  </nav>

  <div class="sidebar-item">
    <p>Tags</p>
  </div>

  <nav class="sidebar-nav">
    
    
      <a class="sidebar-nav-item" href=/tag/webgl/>webgl</a>
    
      <a class="sidebar-nav-item" href=/tag/javascript/>javascript</a>
    
      <a class="sidebar-nav-item" href=/tag/twitter/>twitter</a>
    
      <a class="sidebar-nav-item" href=/tag/nyc/>nyc</a>
    
      <a class="sidebar-nav-item" href=/tag/elasticsearch/>elasticsearch</a>
    
      <a class="sidebar-nav-item" href=/tag/ios/>ios</a>
    
      <a class="sidebar-nav-item" href=/tag/ruby/>ruby</a>
    
      <a class="sidebar-nav-item" href=/tag/elixir/>elixir</a>
    
      <a class="sidebar-nav-item" href=/tag/golang/>golang</a>
    
      <a class="sidebar-nav-item" href=/tag/scala/>scala</a>
    
      <a class="sidebar-nav-item" href=/tag/etl/>etl</a>
    
      <a class="sidebar-nav-item" href=/tag/swift/>swift</a>
    
      <a class="sidebar-nav-item" href=/tag/testing/>testing</a>
    
      <a class="sidebar-nav-item" href=/tag/rails/>rails</a>
    
      <a class="sidebar-nav-item" href=/tag/python/>python</a>
    
      <a class="sidebar-nav-item" href=/tag/business/>business</a>
    
      <a class="sidebar-nav-item" href=/tag/go/>go</a>
    
      <a class="sidebar-nav-item" href=/tag/docker/>docker</a>
    
      <a class="sidebar-nav-item" href=/tag/react/>react</a>
    
      <a class="sidebar-nav-item" href=/tag/tutum/>tutum</a>
    
      <a class="sidebar-nav-item" href=/tag/aws/>aws</a>
    
      <a class="sidebar-nav-item" href=/tag/machine-learning/>machine-learning</a>
    
      <a class="sidebar-nav-item" href=/tag/angular/>angular</a>
    
      <a class="sidebar-nav-item" href=/tag/finance/>finance</a>
    
      <a class="sidebar-nav-item" href=/tag/books/>books</a>
    
      <a class="sidebar-nav-item" href=/tag/octave/>octave</a>
    
      <a class="sidebar-nav-item" href=/tag/kubernetes/>kubernetes</a>
    
      <a class="sidebar-nav-item" href=/tag/coreml/>coreml</a>
    
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2023. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">dimroc</a>
            <small>blog</small>
            <span class="masthead-links">
              <a href="https://experiments.dimroc.com" title="Experiments">See Experiments</a>
            </span>
          </h2>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Centralized Logging of iPhone apps with Papertrail</h1>
  <span class="post-date">08 Jan 2015</span>
  <span class="post-comments"><a href="#disqus_thread"></a></span>
  <p><img src="/public/images/PapertrailForIPhone.png" alt="Papertrail for iPhone" /></p>

<p>I use <a href="https://papertrailapp.com/">Papertrail</a> for all my server logging needs, and love it. I’m almost always bullish on the use of third party
services to offload work from a product dev team. Not too many people want to spend time working on log drains, me included.</p>

<p>When doing iPhone development, working with logs outside of XCode is clumsy at best and usually nonexistent. And when your beta is in the wild, that’s not even an option
because you’re unable to round up all your testers’ devices.</p>

<p>Don’t worry, I’m here to tell you your iOS app can be configured to automatically upload logs to <a href="http://help.papertrailapp.com/kb/configuration/configuring-centralized-logging-from-ios-or-os-x-apps/">Papertrail</a>
as described <a href="http://help.papertrailapp.com/kb/configuration/configuring-centralized-logging-from-ios-or-os-x-apps/">here</a> within 15 minutes.</p>

<!--more-->

<p>###Status Quo
The standard solution for all this are Crash Reports via Apple Connect, Crashlytics, Parse, etc. But these only take you so far because sometimes you need <strong>more
than a call stack.</strong> These logs will complement the crash report.</p>

<p>###Reference Material</p>
<ul>
  <li><a href="https://github.com/CocoaLumberjack/CocoaLumberjack">CocoaLumberjack</a> is a pod that enables one to easily and asynchronously carry logs from the device to a destination, whether it be a terminal, a file, or a service. It’s the keystone to this arch, if you get what I’m saying.</li>
  <li>PapertrailLumberjack allows one to transfer the logs from your iPhone to the Papertrail service.</li>
  <li>Unfortunately, <a href="http://help.papertrailapp.com/kb/configuration/configuring-centralized-logging-from-ios-or-os-x-apps/">the instructions for PapertrailLumberjack</a> are only talking about Objective C,
and they refer to an outdated CocoaLumberjack.</li>
</ul>

<p>###Issues</p>
<ol>
  <li>
    <p>The PapertrailLumberjack pod doesn’t support the current CocoaLumberjack.<br /></p>

    <p>No worries. <a href="https://bitbucket.org/luisrecuenco/papertraillumberjack">There is a patched PaperTrailLumberjack that supports CocoaLumberjack 2.x</a>.</p>
  </li>
  <li>
    <p>PapertrailLumberjack incompatible with Swift CocoaLumberjack.<br /></p>

    <p>I never did get the Swift version of CocoaLumberjack working alongside the Obj C version of PapertrailLumberjack (there’s a nightmare waiting to happen when converting ObjC Macros to Swift)
 so I’m using the ObjC version with <a href="https://gist.github.com/dimroc/2aef1b6b1e391f0085d2">my own Swift wrapper</a> as you can see below.</p>
  </li>
</ol>

<p>As Swift and CocoaPods mature, PaperTrailLumberjack will eventually just work out of the box. Until then:</p>

<p>###Steps:</p>

<ol>
  <li>
    <p>Add CocoaLumberjack 2.x and the patched PaperTrailLumberjack to your Podfile, then <code class="language-plaintext highlighter-rouge">pod install</code>.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">pod</span> <span class="s1">'CocoaLumberjack'</span><span class="p">,</span> <span class="ss">git: </span><span class="s1">'git@github.com:dimroc/CocoaLumberjack.git'</span>
 <span class="n">pod</span> <span class="s1">'PaperTrailLumberjack'</span><span class="p">,</span> <span class="ss">git: </span><span class="s1">'https://bitbucket.org/luisrecuenco/papertraillumberjack.git'</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add the #imports to your bridging header file.</p>

    <pre><code class="language-C++"> #import "CocoaLumberjack.h"
 #import "RMPaperTrailLogger.h"
</code></pre>
  </li>
  <li>
    <p>For Swift, add my DDLogHelper to your project (copy pasta).</p>

    <noscript><pre>import Foundation

</pre></noscript>
  </li>
</ol>
<p>public let defaultDebugLevel = DDLogLevel.Debug
public let defaultTag = NSString(format: "ManhattanForum")</p>

<p>class DDLogHelper {
    class func SwiftLogMacro(async: Bool, level: DDLogLevel, flag flg: DDLogFlag, context: Int = 0, file: String = <strong>FILE</strong>, function: String = <strong>FUNCTION</strong>, line: UWord = <strong>LINE</strong>, tag: AnyObject? = defaultTag, format: String, args: CVaListPointer) {
        let string = NSString(format: format, arguments: args) as String
        SwiftLogMacro(async, level: level, flag: flg, context: context, file: file, function: function, line: line, tag: tag, string: string)
    }</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class func SwiftLogMacro(isAsynchronous: Bool, level: DDLogLevel, flag: DDLogFlag, context: Int = 0, file: String = __FILE__, function: String = __FUNCTION__, line: UInt = __LINE__, tag: AnyObject? = defaultTag, string: String) {
    // Tell the DDLogMessage constructor to copy the C strings that get passed to it.
    // Had to hardcode context to 0.
    let logMessage = DDLogMessage(message: string, level: level, flag: flag, context: context, file: file, function: function, line: line, tag: tag, options: DDLogMessageOptions.CopyFunction | DDLogMessageOptions.CopyFile, timestamp: NSDate())

    DDLog.log(isAsynchronous, message: logMessage)
}

class func debug(logText: String, level: DDLogLevel = defaultDebugLevel, file: String = __FILE__, function: String = __FUNCTION__, line: UWord = __LINE__, asynchronous async: Bool = true, args: CVarArgType...) {
    SwiftLogMacro(async, level: level, flag: DDLogFlag.Debug, file: file, function: function, line: line, format: logText, args: getVaList(args))
} }&lt;/pre&gt;&lt;/noscript&gt;&lt;script src="https://gist.github.com/dimroc/2aef1b6b1e391f0085d2.js"&gt; &lt;/script&gt;
</code></pre></div></div>

<ol>
  <li>
    <p>Configure DDLog and PapertrailLumberjack with your settings.</p>

    <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">class</span> <span class="kd">func</span> <span class="nf">launch</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// Or any initializer method</span>
   <span class="k">let</span> <span class="nv">paperTrailLogger</span> <span class="o">=</span> <span class="kt">RMPaperTrailLogger</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span>
   <span class="n">paperTrailLogger</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="s">"MyHost.papertrailapp.com"</span>
   <span class="n">paperTrailLogger</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">myportnumber</span>

   <span class="kt">DDLog</span><span class="o">.</span><span class="nf">addLogger</span><span class="p">(</span><span class="n">paperTrailLogger</span><span class="p">)</span>
   <span class="kt">DDLog</span><span class="o">.</span><span class="nf">addLogger</span><span class="p">(</span><span class="kt">DDASLLogger</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">())</span>
   <span class="kt">DDLog</span><span class="o">.</span><span class="nf">addLogger</span><span class="p">(</span><span class="kt">DDTTYLogger</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">())</span>
 <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Log away.</p>

    <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kt">DDLogHelper</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Launching Papertrail logging for My App"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>###Conclusion
Compared to what I was doing before, I’m as happy as can be. And this was all with a free hosting plan. I’m still waiting to see what the impact on battery life and performance is. If you have any experience with this, drop me a line below.</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2019/12/31/books-worth-reading-2019/">
            Books Worth Reading 2019
            <small>31 Dec 2019</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/12/31/books-worth-reading-2018/">
            Books Worth Reading 2018
            <small>31 Dec 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/08/12/counting-crowds-with-coreml/">
            Moving AI from the Cloud to the Edge with Crowd Count and Apple's Core ML
            <small>12 Aug 2018</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dimroc'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'dimroc'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>


  </body>
</html>
