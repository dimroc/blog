<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!--iPhone preview -->
  <meta property="og:title" content="Home" />
  <meta property="og:image" content="/" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      dimroc &middot; blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/tagging.css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Javascript -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script src="/public/javascript/detectmobilebrowser.js"></script>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <meta name="google-site-verification" content="KFJOcbe4F4sAQcx11yd_6hmxu0DVdy6ZgI7y6TFK8VU" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43559997-2', 'auto');
  ga('send', 'pageview');
</script>

</head>


  <body class="sidebar-overlay">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <nav class="sidebar-nav">
    <a class="sidebar-nav-item active" href="/">Blog</a>
    <a class="sidebar-nav-item" href="https://github.com/dimroc">GitHub</a>
    <a class="sidebar-nav-item" href="https://experiments.dimroc.com">Experiments</a>

    

    
    
      
        
      
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://twitter.com/dimroc">@dimroc</a>
  </nav>

  <div class="sidebar-item">
    <p>Tags</p>
  </div>

  <nav class="sidebar-nav">
    
    
      <a class="sidebar-nav-item" href=/tag/webgl/>webgl</a>
    
      <a class="sidebar-nav-item" href=/tag/javascript/>javascript</a>
    
      <a class="sidebar-nav-item" href=/tag/twitter/>twitter</a>
    
      <a class="sidebar-nav-item" href=/tag/nyc/>nyc</a>
    
      <a class="sidebar-nav-item" href=/tag/elasticsearch/>elasticsearch</a>
    
      <a class="sidebar-nav-item" href=/tag/ios/>ios</a>
    
      <a class="sidebar-nav-item" href=/tag/ruby/>ruby</a>
    
      <a class="sidebar-nav-item" href=/tag/elixir/>elixir</a>
    
      <a class="sidebar-nav-item" href=/tag/golang/>golang</a>
    
      <a class="sidebar-nav-item" href=/tag/scala/>scala</a>
    
      <a class="sidebar-nav-item" href=/tag/etl/>etl</a>
    
      <a class="sidebar-nav-item" href=/tag/swift/>swift</a>
    
      <a class="sidebar-nav-item" href=/tag/testing/>testing</a>
    
      <a class="sidebar-nav-item" href=/tag/rails/>rails</a>
    
      <a class="sidebar-nav-item" href=/tag/python/>python</a>
    
      <a class="sidebar-nav-item" href=/tag/business/>business</a>
    
      <a class="sidebar-nav-item" href=/tag/go/>go</a>
    
      <a class="sidebar-nav-item" href=/tag/docker/>docker</a>
    
      <a class="sidebar-nav-item" href=/tag/react/>react</a>
    
      <a class="sidebar-nav-item" href=/tag/tutum/>tutum</a>
    
      <a class="sidebar-nav-item" href=/tag/aws/>aws</a>
    
      <a class="sidebar-nav-item" href=/tag/machine-learning/>machine-learning</a>
    
      <a class="sidebar-nav-item" href=/tag/angular/>angular</a>
    
      <a class="sidebar-nav-item" href=/tag/finance/>finance</a>
    
      <a class="sidebar-nav-item" href=/tag/books/>books</a>
    
      <a class="sidebar-nav-item" href=/tag/octave/>octave</a>
    
      <a class="sidebar-nav-item" href=/tag/kubernetes/>kubernetes</a>
    
      <a class="sidebar-nav-item" href=/tag/coreml/>coreml</a>
    
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2023. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">dimroc</a>
            <small>blog</small>
            <span class="masthead-links">
              <a href="https://experiments.dimroc.com" title="Experiments">See Experiments</a>
            </span>
          </h2>
        </div>
      </div>

      <div class="container content">
        <div class="posts index">
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2019/12/31/books-worth-reading-2019/">
        Books Worth Reading 2019
      </a>
    </h3>

    <span class="post-comments"><a href="/2019/12/31/books-worth-reading-2019/#disqus_thread"></a></span>
    <span class="post-date">31 Dec 2019</span>

    <!--<div class="custom summary">-->
      <!--<p>In 2019, nine books made the list, covering idea generation, breadth of skills, and pop-intellectualism:</p>

<ol>
  <li><a href="https://smile.amazon.com/Origin-Wealth-Remaking-Economics-Business-ebook/dp/B077G7834G/ref=sr_1_1?keywords=the+origin+of+wealth&amp;qid=1577976907&amp;s=digital-text&amp;sr=1-1">The Origin of Wealth</a>
    <blockquote>
      <p>Your shirt was not designed; it was evolved.</p>
    </blockquote>

    <ul>
      <li>A conceptually brilliant, hefty academic book that shows how Darwin‚Äôs Theory of Evolution is also applicable to products and the economy.
        <blockquote>
          <p>We are accustomed to thinking of evolution in a biological context, but modern evolutionary theory views evolution as something much more general. Evolution is an algorithm; it is an all-purpose formula for innovation, a formula that, through its special brand of trial and error, creates new designs and solves difficult problems.</p>
        </blockquote>
      </li>
      <li>Touches on a theme also in Christensen‚Äôs ‚ÄúInnovator‚Äôs Dilemma‚Äù: disruptive versus evolutionary innovations. Times ebb and flow between spurts of divergent ideas, only to see a handful succeed and consolidate in a period of convergence.
        <blockquote>
          <p>This book will argue that wealth creation is the product of a simple, but profoundly powerful, three-step formula‚Äîdifferentiate, select, and amplify‚Äîthe formula of evolution.</p>
        </blockquote>
      </li>
      <li>
        <p>Unfortunately, too heavy a read for most. The world would benefit from a concise Gladwell-ized version of the material. Heavy on economic theory and its comparison to other economic models.</p>
      </li>
      <li>
        <p>Touches on the deeper meaning of wealth, that‚Äôs often overlooked. Wealth is not just about how much money you have, but what your money can buy.</p>

        <blockquote>
          <p>But it is not just the absolute level of income that makes New Yorkers so wealthy; it is also the incredible variety of things their wealth can buy. Imagine you had the income of a New Yorker, but you could only spend it on things in the Yanomam√∂ economy. If you spent $36,000 fixing up your mud hut, buying the best clay pots in the village, and eating the finest Yanomam√∂ cuisine, you would be extraordinarily wealthy by Yanomam√∂ standards, but you would still feel far poorer than a typical New Yorker with his or her Nike sneakers, televisions, and vacations in Florida. The number of economic choices the average New Yorker has is staggering. The Wal-Mart near JFK Airport has over 100,000 different items in stock, there are over 200 television channels offered on cable TV, Barnes &amp; Noble lists over 8 million titles, the local supermarket has 275 varieties of breakfast cereal, the typical department store offers 150 types of lipstick, and there are over 50,000 restaurants in New York City alone.</p>
        </blockquote>

        <blockquote>
          <p>Thus, the most dramatic difference between the New Yorker and Yanomam√∂ economies is not their ‚Äúwealth‚Äù measured in dollars, a mere 400-fold difference, but rather the hundred-million-fold, or eight orders of magnitude difference in the complexity and diversity of the New Yorkers‚Äô economy versus the Yanomam√∂ economy.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p><a href="https://smile.amazon.com/Range-Generalists-Triumph-Specialized-World-ebook/dp/B07H1ZYWTM/ref=sr_1_1?keywords=range&amp;qid=1577974948&amp;s=digital-text&amp;sr=1-1">Range</a></p>

    <ul>
      <li>A fantastic, pop-intellectual book that advocates the long term benefits of a broad skillset; namely <em>creative integration</em>.
        <blockquote>
          <p>Individual creators started out with lower innovativeness than teams‚Äîthey were less likely to produce a smash hit‚Äîbut as their experience broadened they actually surpassed teams: an individual creator who had worked in four or more genres was more innovative than a team whose members had collective experience across the same number of genres. Taylor and Greve suggested that ‚Äúindividuals are capable of more creative integration of diverse experiences than teams are.‚Äù</p>
        </blockquote>
      </li>
      <li>Range shows the diminishing returns of a deep skill set, and how Malcolm Gladwell‚Äôs 10k hours is only potent in ‚Äúkind‚Äù learning environments.
        <blockquote>
          <p>Kahneman was focused on the flip side of kind learning environments; Hogarth called them ‚Äúwicked.‚Äù In wicked domains, the rules of the game are often unclear or incomplete, there may or may not be repetitive patterns and they may not be obvious, and feedback is often delayed, inaccurate, or both.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p><a href="https://smile.amazon.com/Lateral-Thinking-Creativity-Step-ebook/dp/B003V1WTLI/ref=tmm_kin_swatch_0?_encoding=UTF8&amp;qid=1577971237&amp;sr=1-2">Lateral Thinking</a></p>

    <ul>
      <li>After stumbling on a now favorite blog post about <a href="https://medium.com/@adamagb/nintendo-s-little-known-product-philosophy-lateral-thinking-with-withered-technology-bac7257d8f4">Nintendo‚Äôs Product Philosophy</a>, I became
 obsessed with Lateral Thinking. In the blog post, and how it‚Äôs often referred to in casual conversation, Lateral Thinking involves taking an idea that‚Äôs prevalent in one vertical, and applying it to a new one.
 i.e. The Z thumbstick in the Nintendo 64 controller took the joystick from arcade games and applied it to consoles.
        <blockquote>
          <p>You cannot dig a hole in a different place by digging the same hole deeper. Vertical thinking is used to dig the same hole deeper. Lateral thinking is used to dig a hole in a different place.</p>
        </blockquote>

        <blockquote>
          <p>With vertical thinking one has to be correct at every step, with lateral thinking one does not have to be</p>
        </blockquote>
      </li>
      <li>After further reading, I have come to understand Lateral Thinking as introduced by Edward de Bono.
 Often oversimplified to a brainstorm session, Lateral Thinking is a philosophy and thought process used to shake up existing patterns or assumptions,
 with the goal of coming up with new ones.
        <blockquote>
          <p>Vertical thinking is selective, lateral thinking is generative</p>
        </blockquote>

        <blockquote>
          <p>The purpose of thinking is not to be right but to be effective. Being effective does eventually involve being right but there is a very important difference between the two. Being right means being right all the time. Being effective means being right only at the end.</p>
        </blockquote>
      </li>
      <li>Simple way to practice? Clever analogies.
        <blockquote>
          <p>Description is certainly the easiest setting in which to practise lateral thinking because there is always some result. [i.e. Sports analogies used to describe business]</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p><a href="https://smile.amazon.com/technique-producing-ideas-simple-formula-ebook/dp/B0145R7R22/ref=sr_1_1?crid=3K7ZPFWKQERHA&amp;keywords=a+technique+for+producing+ideas&amp;qid=1577976266&amp;s=digital-text&amp;sprefix=a+technique+%2Cdigital-text%2C140&amp;sr=1-1">A Technique for Producing Ideas</a></p>

    <ul>
      <li>A 46 page book where author James Webb Young reversed-engineered his capacity for ingenuity, so that others could replicate his success.
        <blockquote>
          <p>an idea is nothing more nor less than a new combination of old elements.</p>
        </blockquote>
      </li>
      <li>Best described by a twist to Steve Job‚Äôs quote:
        <blockquote>
          <p>Good artists copy; great artists steal [and add it to something else].</p>
        </blockquote>
      </li>
      <li>I‚Äôm always a sucker for a concise <a href="https://en.wikipedia.org/wiki/The_Elements_of_Style">‚ÄúElements of Style‚Äù</a> type of book.</li>
    </ul>
  </li>
  <li>
    <p><a href="https://smile.amazon.com/Mindset-Psychology-Carol-S-Dweck/dp/0345472322/ref=sr_1_3?keywords=mindset&amp;qid=1577970635&amp;sr=8-3">Mindset</a></p>

    <ul>
      <li>A fantastic, behavior-changing book advocating the growth mindset, and how to apply it to one‚Äôs life.
        <blockquote>
          <p>Benjamin Barber, an eminent political theorist, once said, ‚ÄúI don‚Äôt divide the world into the weak and the strong, or the successes and the failures‚Ä¶.I divide the world into the learners and nonlearners.‚Äù</p>
        </blockquote>
      </li>
      <li>
        <p>Breaks down the differences between fixed and growth mindsets, and how we all have both. Illustrates the power of a change in perspective. Focus on the journey of growth, rather than a destination of either success or failure.</p>
      </li>
      <li>Adding ammunition for my battle against the philosophy of the ‚Äúeasy A‚Äù, where one drops a real challenge to pad their stats, the author debunks the myth that your IQ is fixed and can‚Äôt be improved:
        <blockquote>
          <p>Wasn‚Äôt the IQ test meant to summarize children‚Äôs unchangeable intelligence? In fact, no. Binet, a Frenchman working in Paris in the early twentieth century, designed this test to identify children who were not profiting from the Paris public schools, so that new educational programs could be designed to get them back on track.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/Anti-Intellectualism-American-Life-Richard-Hofstadter-ebook/dp/B006LSVB1M/ref=sr_1_1?crid=7JF2N2XV6UVM&amp;keywords=antiintellectualism+in+american+life&amp;qid=1577972451&amp;s=digital-text&amp;sprefix=antiintellec%2Cdigital-text%2C136&amp;sr=1-1">Anti-Intellectualism in American Life</a>
    <blockquote>
      <p>The Sputnik was more than a shock to American national vanity: it brought an immense amount of attention to bear on the consequences of anti-intellectualism in the school system and in American life at large. Suddenly the national distaste for intellect appeared to be not just a disgrace but a hazard to survival.</p>
    </blockquote>

    <ul>
      <li>Trump‚Äôs election and the resulting change in America‚Äôs image triggered some personal introspection, which led me to this book. Rest assured, America has seen much of this before. What remains to be seen is how technology will affect it.
        <blockquote>
          <p>Anti-intellectualism was not manifested in this country for the first time during the 1950‚Äôs. Our anti-intellectualism is, in fact, older than our national identity, and has a long historical background.</p>
        </blockquote>
      </li>
      <li>An incredibly prescient book that shows this populist movement isn‚Äôt entirely unique in history, and, like so much of America, is the result of a swinging pendulum, a recurring ebb and flow.
        <blockquote>
          <p>An examination of this background suggests that regard for intellectuals in the United States has not moved steadily downward and has not gone into a sudden, recent decline, but is subject to cyclical fluctuations; it suggests, too, that the resentment from which the intellectual has suffered in our time is a manifestation not of a decline in his position but of his increasing prominence.</p>
        </blockquote>
      </li>
      <li>What is intellect? Critical thinking for the sake of critical thinking. Anti-intellectualism should not be misinterpreted as the love by or of idiots, nor should it be conflated with anti-intelligence. Businessmen, advocates of outdated ideas, and champions of pragmatism exercise anti-intellectualism, sometimes correctly so.
        <blockquote>
          <p>Quite the contrary: just as the most effective enemy of the educated man may be the half-educated man, so the leading anti-intellectuals are usually men deeply engaged with ideas, often obsessively engaged with this or that outworn or rejected idea.</p>
        </blockquote>

        <blockquote>
          <p>Intellect, on the other hand, is the critical, creative, and contemplative side of mind. Whereas intelligence seeks to grasp, manipulate, re-order, adjust, intellect examines, ponders, wonders, theorizes, criticizes, imagines. Intelligence will seize the immediate meaning in a situation and evaluate it. Intellect evaluates evaluations, and looks for the meanings of situations as a whole.</p>
        </blockquote>
      </li>
      <li>A heavy academic read, that won‚Äôt be finished by most who start it.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/Talking-Strangers-Should-about-People-ebook/dp/B07NDKVWZW/ref=sr_1_1?keywords=talking+to+strangers&amp;qid=1577971943&amp;s=digital-text&amp;sr=1-1">Talking to Strangers</a>
    <ul>
      <li>
        <p>Another Malcolm Gladwell journey that helps to analyze some of the more modern catastrophes in social judgement, ranging from Sandra Brand to Amanda Knox. Using current events and case studies
 to illustrate a particular facet of global human judgement, he explains our inefficacy at talking to strangers because of three verticals:</p>

        <ol>
          <li>Defaulting to truth.
            <ul>
              <li>Defaulting to skepticism would lead civilization to a standstill. Progress favors trust.</li>
            </ul>
          </li>
          <li>Illusion of Transparency.
            <ul>
              <li>We all think we can read people, but we can‚Äôt.</li>
            </ul>
          </li>
          <li>Coupling of thoughts to actions or presumptions.
            <ul>
              <li>In SF and Seattle, suicidal thoughts lead to jumping off a bridge. Will removing the bridge just lead people to find other ways of suicide? Many studies say no.</li>
              <li>Do we subconsiously couple an image, item, race, religion to an assumption? Like a car with green tree air freshener probably being used by someone who smokes Cannabis?</li>
            </ul>
          </li>
        </ol>
      </li>
    </ul>
  </li>
  <li>
    <p><a href="https://smile.amazon.com/Unlimited-Memory-Advanced-Strategies-Productive-ebook/dp/B00I3QS1XQ/ref=sr_1_1_sspa?crid=2CIHW7SC36ING&amp;keywords=unlimited+memory&amp;qid=1577973509&amp;s=digital-text&amp;sprefix=unlimited+%2Cdigital-text%2C136&amp;sr=1-1-spons&amp;psc=1&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUFVSjZQVDFZVlRCV0ImZW5jcnlwdGVkSWQ9QTA1MDM0NTMzVTNHSEpTTlowWkFJJmVuY3J5cHRlZEFkSWQ9QTA2NTgzODIzRzhCV01DNUdMMVlMJndpZGdldE5hbWU9c3BfYXRmJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ==">Unlimited Memory</a></p>

    <ul>
      <li>Written by an International Grandmaster of Memory, Kevin Horsley walks through techniques for improving your memory.</li>
      <li>Shows how to leverage your Visual IQ in creative ways, even if what you want to remember is auditory or text.
        <blockquote>
          <p>As neuroscientist John Medina says, ‚ÄúHear a piece of information and three days later you‚Äôll remember 10% of it. Add a picture and you‚Äôll remember 65%.‚Äù</p>
        </blockquote>
      </li>
      <li>I‚Äôm honestly surprised this wasn‚Äôt covered with more emphasis in middle school and highschool. Maybe it was and I ignored it.
        <blockquote>
          <p>‚ÄúInterest level is measured by how much you remember.‚Äù ~ Philip A. Bossert</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p><a href="https://smile.amazon.com/Measure-What-Matters-Google-Foundation-ebook/dp/B078FZ9SYB/ref=sr_1_2?crid=S0IFK8IMA96G&amp;keywords=measure+what+matters&amp;qid=1577974582&amp;s=digital-text&amp;sprefix=measure+what%2Cdigital-text%2C134&amp;sr=1-2">Measure What Matters</a></p>

    <blockquote>
      <p>The practice that molded me at Intel and saved me at Sun‚Äîthat still inspires me today‚Äîis called OKRs. Short for Objectives and Key Results.</p>
    </blockquote>

    <ul>
      <li>Insightful book about the goal tracking and managerial process used to help align goals horizontally (at different levels of seniority) and vertically (across roles and functions).</li>
      <li>A mix of case studies and how-tos, John Doerr walks you through implementing your own OKRs in your org.
        <blockquote>
          <p>Many companies have a ‚Äúrule of seven,‚Äù limiting managers to a maximum of seven direct reports. In some cases, Google has flipped the rule to a minimum of seven. (When Jonathan Rosenberg headed Google‚Äôs product team, he had as many as twenty.) The higher the ratio of reports, the flatter the org chart‚Äîwhich means less top-down oversight, greater frontline autonomy, and more fertile soil for the next breakthrough. OKRs help make all of these good things possible.</p>
        </blockquote>
      </li>
      <li>Interesting tidbit on the personalities sought by old school Intel:
        <blockquote>
          <p>At Intel, Andy recruited ‚Äúaggressive introverts‚Äù in his own image, people who solved problems quickly, objectively, systematically, and permanently. Following his lead, they were skilled at confronting a problem without attacking the person. They set politics aside to make faster, sounder, more collective decisions.</p>
        </blockquote>
      </li>
    </ul>
  </li>
</ol>

-->
      <!--<a class="more" href="/2019/12/31/books-worth-reading-2019/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2018/12/31/books-worth-reading-2018/">
        Books Worth Reading 2018
      </a>
    </h3>

    <span class="post-comments"><a href="/2018/12/31/books-worth-reading-2018/#disqus_thread"></a></span>
    <span class="post-date">31 Dec 2018</span>

    <!--<div class="custom summary">-->
      <!--<p>A slow reading year üòû.
Continued to read up on soft skills, but see that slowing down next year. Garbage books don‚Äôt make the list.
Prioritized in terms of preference:</p>

<ol>
  <li><a href="https://smile.amazon.com/dp/B07HRLQSLG?ref_=k4w_ss_dp_lp">The Curse of Bigness: Antitrust in the New Gilded Age</a>
    <blockquote>
      <p>It became apparent, in retrospect, just how much innovation the Bell system monopoly had been holding back. For out of the carcass of AT&amp; T emerged entirely new types of industries unimagined or unimaginable during the reign of AT&amp; T. For example, the liberty to sell things to consumers that plugged into a (new) phone jack not only yielded the answering machine, but the home modulator/ demodulator, or modem, allowing a home computer to speak with a network. That, in turn, made feasible an industry of ‚Äúonline service providers‚Äù like AOL or Compuserve, which themselves spawned internet service providers that were accessible from home, producing the Internet revolution.</p>
    </blockquote>

    <ul>
      <li>Fantastic read on the origins and evolution of Antitrust. Starting from Teddy Roosevelt ‚Äòtrustbusting‚Äô in the Second Industrial Revoluion
 to its transformation by the Chicago School to emphasize on consumer prices, resulting in its lack of enforcement in the current Tech trust era.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/dp/B00ICN066A/ref=dp-kindle-redirect?_encoding=UTF8&amp;btkr=1">Sapiens</a>
    <blockquote>
      <p>The Scientific Revolution has not been a revolution of knowledge. It has been above all a revolution of ignorance. The great discovery that launched the Scientific Revolution was the discovery that humans do not know the answers to their most important questions.
 Premodern traditions of knowledge such as Islam, Christianity, Buddhism and Confucianism asserted that everything that is important to know about the world was already known. The great gods, or the one almighty God, or the wise people of the past possessed all-encompassing wisdom, which they revealed to us in scriptures and oral traditions.</p>
    </blockquote>

    <ul>
      <li>An amazing walk through mankind‚Äôs history, showing how different organizational structures helped humans
 coordinate local tribes to a globe of billions. These devices include mercantilism, religion, and ideology, and show the adverse effect it‚Äôs had on the world.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/Emotional-Intelligence-Matter-More-Than-ebook/dp/B000JMKVCG/ref=sr_1_5?s=digital-text&amp;ie=UTF8&amp;qid=1546700114&amp;sr=1-5&amp;keywords=emotional+intelligence">Emotional Intelligence</a>
    <blockquote>
      <p>Anyone can become angry‚Äîthat is easy. But to be angry with the right person, to the right degree, at the right time, for the right purpose, and in the right way‚Äîthat is not easy. - ARISTOTLE, The Nichomachean Ethics</p>
    </blockquote>

    <ul>
      <li>The book that trailblazed the term EI (or EQ) walks through in academic detail the different facets of the space that separates itself from IQ, and how to use
 it in every day life.</li>
      <li>Wish I understood this as a teenager.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/Extreme-Ownership-U-S-Navy-SEALs-ebook/dp/B0739PYQSS/ref=sr_1_4?s=digital-text&amp;ie=UTF8&amp;qid=1546700069&amp;sr=1-4&amp;keywords=extreme+ownership">Extreme Ownership</a>
    <blockquote>
      <p>Leaders must own everything in their world. There is no one else to blame [but themself]‚Ä¶
Whether in SEAL training, in combat on distant battlefields, in business, or in life: there are no bad teams, only bad leaders.</p>
    </blockquote>

    <ul>
      <li>An ideology taken from the special forces and brought to business, documented with conviction
 over a series of case studies alternating from operations in the Iraqi War to scenarios in Corporate America.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/Homage-Catalonia-George-Orwell-ebook/dp/B003K16PFU/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1546700172&amp;sr=1-1&amp;keywords=homage+to+catalonia">Homage to Catalonia</a>
    <blockquote>
      <p>Beware of my partisanship, my mistakes of fact, and the distortion inevitably caused by my having seen only one corner of events.</p>
    </blockquote>

    <ul>
      <li>An autobiographical account of George Owell‚Äôs time fighting in the Spanish Civil War. Written with a candor that is lost in much of today‚Äôs journalism.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/EQ-Applied-Real-World-Emotional-Intelligence-ebook/dp/B07D7K938G/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1546700152&amp;sr=1-1&amp;keywords=eq+applied">EQ Applied</a>
    <blockquote>
      <p>The concept of the growth mindset has gained popularity in recent years, partially due to the work of Stanford psychology professor Carol Dweck. In her book Mindset, Dweck advocates that individuals who believe their talents can be developed through hard work, good strategies, and input from others (growth mindset) tend to achieve more than those who believe their talents are innate gifts with finite development potential (fixed mindset).</p>
    </blockquote>

    <ul>
      <li>A less pedantic more palatable introduction to emotional intelligence, broken down into four abilities: self-awareness, self-management, social awareness, relationship management.</li>
    </ul>
  </li>
  <li><a href="https://smile.amazon.com/Concurrency-Go-Tools-Techniques-Developers-ebook/dp/B0742NH2SG/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1546700139&amp;sr=1-1&amp;keywords=concurrency+in+go">Concurrency In Go, especially chapter 4</a>
    <blockquote>
      <p>The first is that we do not write parallel code, only concurrent code that we hope will be run in parallel. Once again, parallelism is a property of the runtime of our program, not the code.</p>
    </blockquote>

    <ul>
      <li>A fantastic read on responsible, error handling concurrent code in the soon to be dominant systems programming language.</li>
    </ul>
  </li>
</ol>
-->
      <!--<a class="more" href="/2018/12/31/books-worth-reading-2018/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2018/08/12/counting-crowds-with-coreml/">
        Moving AI from the Cloud to the Edge with Crowd Count and Apple's Core ML
      </a>
    </h3>

    <span class="post-comments"><a href="/2018/08/12/counting-crowds-with-coreml/#disqus_thread"></a></span>
    <span class="post-date">12 Aug 2018</span>

    <!--<div class="custom summary">-->
      <!--<p><img src="/public/images/count/CrowdCountiOS.gif" alt="iOS Crowd Counting in action" /></p>

<p>After successfully counting crowds in python, <a href="/2017/11/19/counting-crowds-and-lines/">which you can read about
here</a>, I took it upon myself to run the very same models
on the iPhone with Core ML (ML: Machine Learning).
Core ML and MLKit open up a new domain for computing that‚Äôs being branded as Edge AI, where neural networks run on a local device (edge) as opposed to the cloud.
The <a href="https://github.com/dimroc/count/tree/master/ios">source code for this experiment is available here</a>.</p>

<p>Transitioning from a fixed camera <a href="https://count.dimroc.com">(ShakeCam Madison Square Park)</a>
to a general purpose iPhone app meant handling a wider variety of input. Are we counting three
people or three thousand people?
In this article, we‚Äôll go over eight facets of the port, from migrating Cloud AI to Edge AI
to handling wildly different inputs:</p>

<ol>
  <li>Using a two stage ML pipeline to handle different inputs</li>
  <li>First stage: Building the Crowd Classifier with Create ML</li>
  <li>Second stage: Different densities, different prediction models: singles, tens, hundreds+</li>
  <li>Python coremltools to convert Keras to Core ML</li>
  <li>Why an Xcode Playground for Core ML became a macOS App (Playgrounds are too brittle)</li>
  <li>Swift Architecture: RxSwift and MVVM</li>
  <li>Performance: Better than expected</li>
  <li>Promising Future for Edge AI</li>
</ol>

<hr />

<h2 id="1-using-a-two-stage-ml-pipeline-to-handle-different-inputs">1. Using a two stage ML pipeline to handle different inputs</h2>

<p>iPhone camera input can vary wildly. Are we counting a selfie or a football stadium?
Our counting model doesn‚Äôt handle that type of variety well.
To mitigate this, we tailor make prediction models to accommodate a particular
density, and then use image classification to pick the best strategy.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Crowd Classification -&gt; either singles, tens or hundreds crowd prediction -&gt; count of people
</code></pre></div></div>

<p><img src="/public/images/count/CrowdCountStrategies.jpg" alt="Crowd Count Strategies" width="600px" /></p>

<h2 id="2-building-the-crowd-classifier-with-create-ml">2. Building the Crowd Classifier with Create ML</h2>

<p>Apple‚Äôs new <a href="https://developer.apple.com/documentation/createml">Create ML tool</a>
allows you to build a classifier by simply dragging in a folder.
This was used to classify images as either singles, tens, or hundreds, as a first step
in the ML pipeline.</p>

<p><img src="/public/images/count/CrowdClassifier.png" alt="Crowd Classifier" width="600px" /></p>

<h2 id="3-different-densities-different-prediction-models-singles-tens-hundreds">3. Different densities, different prediction models: singles, tens, hundreds+</h2>

<p>These crowd counting models (from the previous post) are heavily skewed to particular densities. For example,
the model used to count three people, will have a hard time with one thousand people.
They are based on the paper <a href="https://arxiv.org/pdf/1702.02359.pdf">Multi-Scale Convolutional Neural Networks for Crowd Counting</a>.
To mitigate this, we have three models:</p>

<p><img src="/public/images/count/CrowdCountStrategies.jpg" alt="Crowd Count Strategies" width="600px" /></p>

<ul>
  <li>singles: Uses Apple‚Äôs built in face detection (<a href="https://developer.apple.com/documentation/vision/vndetectfacerectanglesrequest">VNDetectFaceRectanglesRequest</a>). You can beat it by showing the back of your head!</li>
  <li>tens: Uses the model overtrained for the <a href="https://count.dimroc.com/">ShakeCam</a> in the previous crowd counting post, which has between zero to eighty people. The tens category desparately needs a newly trained model.</li>
  <li>hundreds: Uses a model built with the <a href="http://crcv.ucf.edu/data/crowd.php">UCF Crowd dataset</a>.</li>
</ul>

<p>This would be the final step in the two step ML pipeline. These models, however,
are still in the python Keras format. Let‚Äôs convert them to Core ML.</p>

<h2 id="4-python-coremltools-to-convert-keras-to-core-ml">4. Python coremltools to convert Keras to Core ML</h2>

<p>Apple‚Äôs <a href="https://github.com/apple/coremltools">coremltools</a> convert existing
Keras models to Core ML. It worked well with one exception: arbitrarily (not fixed) sized images.</p>

<p>The top variable sized layer had to be replaced with a fixed size layer to better work
with Core ML. Variable sized input has come to Core ML, but support and documentation still has a way to go.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="nf">load_model</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="c1"># Create a new input layer to replace the (None,None,3) input layer
</span><span class="n">input_layer</span> <span class="o">=</span> <span class="nc">InputLayer</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">675</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"input_1"</span><span class="p">)</span>

<span class="c1"># Save
</span><span class="n">intermediary_path</span> <span class="o">=</span> <span class="s">"tmp/reshaped_model.h5"</span>
<span class="n">model</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_layer</span>
<span class="n">model</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">intermediary_path</span><span class="p">)</span>

<span class="c1"># Convert
</span><span class="n">coreml_model</span> <span class="o">=</span> <span class="n">coremltools</span><span class="p">.</span><span class="n">converters</span><span class="p">.</span><span class="n">Keras</span><span class="p">.</span><span class="nf">convert</span><span class="p">(</span>
    <span class="n">intermediary_path</span><span class="p">,</span>
    <span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s">'input_1'</span><span class="p">],</span>
    <span class="n">image_input_names</span><span class="o">=</span><span class="p">[</span><span class="s">'input_1'</span><span class="p">],</span>
    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s">'density_map'</span><span class="p">])</span>

<span class="n">coreml_model</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="s">"CrowdPredictor.mlmodel"</span><span class="p">)</span>
</code></pre></div></div>

<p><a href="https://github.com/dimroc/count/blob/master/ml/crowdcount/management/commands/convert_to_coreml.py">Source</a></p>

<p>Now that we have our Core ML pipeline, a crowd classifier feeding into a crowd predictor, let‚Äôs
see it in action.</p>

<h2 id="5-why-an-xcode-playground-for-core-ml-became-a-macos-app-playgrounds-are-too-brittle">5. Why an Xcode Playground for Core ML became a macOS App (Playgrounds are too brittle)</h2>

<p>I was under the impression that the fastest way to a functional prototype was
an Xcode Playground. Inspired by Create ML, the Xcode playground promised to be
a quick and easy prototype for the iOS application.</p>

<p>When it works, it‚Äôs great.</p>

<p><img src="/public/images/count/CountPlayground.jpg" alt="Crowd Playground" width="600px" /></p>

<p>A significant downside to playgrounds however, is its inability to be an Xcode target,
meaning it is unable to have linker and build dependencies. As you use
CocoaPods or Cartography for third party library management, this will break you, and you‚Äôll
end up with spurious errors like the follow:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>error: Couldn't lookup symbols:
  type metadata for CrowdCountApiMac.FriendlyClassification
  ...
  __swift_FORCE_LOAD_$_swiftCoreMedia
  __swift_FORCE_LOAD_$_swiftCoreAudio
  CrowdCountApiMac.FriendlyPredictor.DensityMapWidth.unsafeMutableAddressor : Swift.Int
  ...
</code></pre></div></div>

<p>The good news is that porting over to a macOS application is relativately straighforward, and will fix all of this.
A macOS app is an Xcode target and can therefore link frameworks and binaries, allowing reliable
compilation and linking.</p>

<h2 id="6-swift-architecture-rxswift-and-mvvm">6. Swift Architecture: RxSwift and MVVM</h2>

<p><a href="https://github.com/ReactiveX/RxSwift/">RxSwift</a> drove out an MVVM (Model-View-ViewModel) architecture,
where Apple‚Äôs ViewControllers are the View. So really M(VC)VM.
But these ViewController‚Äôs are lean, and merely drive the View or glue the VM.</p>

<p><img src="/public/images/count/MVCVM.jpg" alt="M(VC)VM" width="600px" /></p>

<p>There are <a href="https://medium.com/@daltonclaybrook/rxswift-mvvm-a-little-at-a-time-81ac17dcf285">many</a>
<a href="https://medium.com/@navdeepsingh_2336/creating-an-ios-app-with-mvvm-and-rxswift-in-minutes-b8800633d2e8">articles</a>
<a href="https://medium.com/@dkhuong291/rxswift-with-mvvm-e4af71413298">on this topic</a>. Feel free to google for more information.</p>

<h2 id="7-performance-better-than-expected">7. Performance: Better than expected</h2>

<p>While extracting frames from the camera in real time, classification took ~100ms and crowd counting taking ~3 seconds.
Good to see that iPhone X GPU being put to good use.</p>

<p>Word of advice: do not do your own image and MLMultiArray manipulation.
Use Apple‚Äôs Vision API, such as <a href="https://developer.apple.com/documentation/vision/vnimagerequesthandler">VNImageRequestHandler</a>,
that makes better use of hardware.</p>

<h2 id="8-promising-future-for-edge-ai">8. Promising Future for Edge AI</h2>

<p>The ability to run sophisticated neural networks, in this case
a multi-column <a href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/">CNN</a>,
on your iPhone rather than the cloud, and in real time, is a watershed moment.</p>

<p>Sure, this already existed in applications like Prisma and Google translate, but the ease of development
will present many more opportunities.</p>

<p>With millions of iPhones in use, it‚Äôll be easier than ever to crowd source data from
your willing users to improve your model, and create a virtuous cycle that will improve the product:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usage -&gt; more data -&gt; improved usage -&gt; more data -&gt; improved usage -&gt; ...
</code></pre></div></div>

<p>This proof of concept shows that it‚Äôs doable, and that, in and of itself, is a milestone.
Add in the performance and the iPhone‚Äôs ubiquity, and we have a promising future.</p>
-->
      <!--<a class="more" href="/2018/08/12/counting-crowds-with-coreml/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2017/12/30/books-worth-reading-2017/">
        Books Worth Reading 2017
      </a>
    </h3>

    <span class="post-comments"><a href="/2017/12/30/books-worth-reading-2017/#disqus_thread"></a></span>
    <span class="post-date">30 Dec 2017</span>

    <!--<div class="custom summary">-->
      <!--<p>Quite the focus on soft skills and nonfiction this year. Garbage books don‚Äôt make the list.
Prioritized in terms of preference:</p>

<ol>
  <li><a href="https://smile.amazon.com/Creativity-Inc-Overcoming-Unseen-Inspiration-ebook/dp/B00FUZQYBO/ref=sr_1_1_twi_kin_1?ie=UTF8&amp;qid=1514640302&amp;sr=8-1&amp;keywords=creativity+inc+by+ed+catmull">Creativity, Inc.</a></li>
  <li><a href="https://smile.amazon.com/Getting-Yes-Negotiating-Agreement-Without-ebook/dp/B0051SDM5Q/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640391&amp;sr=1-1&amp;keywords=getting+to+yes">Getting To Yes</a></li>
  <li><a href="https://smile.amazon.com/Anything-You-Want-Lessons-Entrepreneur-ebook/dp/B00SI0B5FS/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640410&amp;sr=1-1&amp;keywords=anything+you+want+derek+sivers">Anything You Want</a></li>
  <li><a href="https://smile.amazon.com/Good-They-Cant-Ignore-You-ebook/dp/B0076DDBJ6/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640425&amp;sr=1-1&amp;keywords=so+good+they+can%27t+ignore+you">So Good They Can‚Äôt Ignore You</a></li>
  <li><a href="https://smile.amazon.com/Draw-Win-Course-Innovate-Visual-ebook/dp/B01BD1STL6/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640441&amp;sr=1-1&amp;keywords=draw+to+win">Draw To Win</a></li>
  <li><a href="https://smile.amazon.com/Influence-Psychology-Persuasion-Business-Essentials-ebook/dp/B002BD2UUC/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640460&amp;sr=1-1&amp;keywords=influence+the+psychology+of+persuasion">Influence: The Psychology of Persuasion</a></li>
  <li><a href="https://smile.amazon.com/Start-Why-Leaders-Inspire-Everyone-ebook/dp/B002Q6XUE4/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640489&amp;sr=1-1&amp;keywords=start+with+why">Start With Why</a></li>
  <li><a href="https://smile.amazon.com/Hacking-Growth-Fastest-Growing-Companies-Breakout-ebook/dp/B01IZTCF6Y/ref=sr_1_1?s=digital-text&amp;ie=UTF8&amp;qid=1514640503&amp;sr=1-1&amp;keywords=hacking+growth">Hacking Growth</a></li>
</ol>
-->
      <!--<a class="more" href="/2017/12/30/books-worth-reading-2017/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2017/11/19/counting-crowds-and-lines/">
        Counting Crowds and Lines with AI
      </a>
    </h3>

    <span class="post-comments"><a href="/2017/11/19/counting-crowds-and-lines/#disqus_thread"></a></span>
    <span class="post-date">19 Nov 2017</span>

    <!--<div class="custom summary">-->
      <!--<video src="/public/videos/mallcount.mp4" controls="true" type="video/mp4" width="600px"></video>
<p><em>* Data courtesy of the <a href="http://personal.ie.cuhk.edu.hk/~ccloy/downloads_mall_dataset.html">CUHK Mall Dataset</a></em><br />
<em>* <a href="/public/images/count/countLandingPage.jpg" target="_blank">Screenshot of decommissioned website Count: Quantified imagery SaaS</a></em>
<br />
<em>* Feel free to check out the <a href="https://github.com/dimroc/counting_company">source code</a>.</em><br />
<em>* Check out <a href="/2018/08/12/counting-crowds-with-coreml/">part 2: counting people on your iPhone with CoreML</a>.</em><br /></p>

<hr />

<p>In Union Square, NYC, there‚Äôs the always crowded burger spot Shake Shack.
A group of us would obsessively check the <a href="https://www.shakeshack.com/location/madison-square-park/">Shake Cam</a>
around lunch to figure out if a bite was worth the wait.</p>

<p><a href="https://www.shakeshack.com/location/madison-square-park" target="_blank">
<img src="/public/images/count/shakecam.jpg" alt="Shake Cam" width="200px" />
</a></p>
<center><small>14 person line, not bad</small></center>

<p>Rather than do this manually (come on, it‚Äôs nearly 2018), it would be great if this could be done
for us. Then, to take that idea further, imagine being able to measure foot traffic on a month to month basis
or to measure the impact of a new promotional campaign.</p>

<p><a href="https://count.dimroc.com" target="_blank">
<img src="/public/images/count/countLineDualShot.jpg" alt="Count Alpha" width="600px" />
</a></p>

<p>Object detection has received a lot of attention in the deep learning space, but it‚Äôs
ill-suited for highly congested scenes like crowds. In this post, I‚Äôll talk about
how I implemented <a href="https://arxiv.org/pdf/1702.02359.pdf">multi-scale convolutional neural network (CNN)</a>
for crowd and line counting.</p>

<h2 id="why-not-object-detection">Why not object detection</h2>

<p>Regional-CNN‚Äôs (R-CNN) use a sliding window to find an object. High density crowds are ill-suited for
sliding windows due to high occlusion:</p>

<p><img src="/public/images/count/rcnnfail.jpg" alt="R-CNN" width="300px" /></p>
<center><small>Failed attempt with off the shelf (no retraining) TensorFlow R-CNN</small></center>

<p>Further exploration in this approach led me to <a href="https://github.com/Russell91/TensorBox">TensorBox</a>,
but it too had issues with high congestion and large crowd counts.</p>

<h2 id="density-maps-to-the-rescue">Density Maps to the rescue</h2>

<p>Rather than a sliding window, density maps (aka heat maps) estimate the likelihood of a head
being at a location:
<img src="/public/images/count/ucfOriginal.jpg" alt="UCF Original" width="400px" />
<img src="/public/images/count/ucfcrowd.jpg" alt="Dense Crowd Ground Truth" width="500px" /></p>
<center><a href="http://crcv.ucf.edu/data/crowd.php" target="_blank"><small>
Crowd photo from the UCF Dataset
</small></a></center>

<p>3406 vs 3408? Pretty close!</p>

<h3 id="whats-happening-here">What‚Äôs happening here?</h3>

<p><img src="/public/images/count/multiscale-cnn.jpg" alt="Multi-scale CNN" /></p>

<p>Based on <a href="https://arxiv.org/pdf/1702.02359.pdf">multi-scale convolutional neural network (CNN) for crowd counting</a>,
the ground truth is generated by taking the head annotations and setting that pixel value to one, and
then gaussian blurring the image. The model is then trained to output these blurred images, or density maps.
The sum of all the image pixels then results in the crowd count prediction. Read the <a href="https://arxiv.org/pdf/1702.02359.pdf">paper</a> for more insight.</p>

<p>Let‚Äôs look at density maps applied to the shake cam. Don‚Äôt worry about the color switch from blue to white for the density maps.
<img src="/public/images/count/predictionBreakdown.jpg" alt="Dense Crowd Ground Truth" width="500px" /></p>
<center><small>The sum of the pixel values is the size of the crowd</small></center>

<p>As you can see above, we have:</p>

<ol>
  <li>The annotated image courtesy of AWS Mechanical Turk.</li>
  <li>The calculated ground truth by setting head locations to one and then gaussian blurring.</li>
  <li>The model‚Äôs prediction after being trained with ground truths.</li>
</ol>

<h2 id="how-to-get-the-images">How to get the images?</h2>

<p>From your neighborhood <a href="https://www.shakeshack.com/location/madison-square-park">Shake Shack Cam</a> of course.</p>

<h2 id="how-to-annotate-the-data">How to annotate the data?</h2>

<p>The tried and true AWS Mechanical Turk, with a twist: a mouse click annotates a head as shown below:
<img src="/public/images/count/headAnnotator.jpg" alt="Head Annotator" width="400px" /></p>

<p>I went ahead and modified the <a href="https://github.com/kyamagu/bbox-annotator">bbox-annotator</a>
to be a single click <a href="https://github.com/dimroc/head-annotator">head annotator</a>.</p>

<h2 id="how-to-count-the-line">How to count the line?</h2>

<p>Lines aren‚Äôt merely people in a certain space, they are people standing next to each other
to form a contiguous collection of people. As of now, I simply feed the density map into a
three layer fully connected (FC) network to output a single number, the line count.</p>

<p>Gathering data for that also ended up being a task in AWS Mechanical Turk.</p>

<p>Here are some examples of where lines aren‚Äôt immediately obvious:</p>

<p><img src="/public/images/count/lineNotHot.jpg" alt="Line Not Hot" width="400px" />
<img src="/public/images/count/lineNotHot2.jpg" alt="Line Not Hot" width="400px" /></p>

<h2 id="making-a-product-out-of-data-science">Making a product out of data science</h2>

<p>This is all good fun working on your development box, but how do you host it? This
will be a topic for another blog post, but the short story is:</p>

<ol>
  <li>Make sure it doesn‚Äôt look bad! Thanks to the design work done by Steve @ <a href="http://thoughtmerchants.com/">thoughtmerchants.com</a></li>
  <li>Use Vue JS and d3 to visualize the line count.</li>
  <li>Create a docker image with your static assets and Conda dependencies.</li>
  <li>Deploy to GCP with kubernetes on Google Container Engine.</li>
  <li>Periodically run a background job to scrape the shake cam image and run a prediction.</li>
</ol>

<p><img src="/public/images/count/countalpha.jpg" alt="Count Alpha" width="400px" /></p>

<p>I did the extra credit step of having a Rails application interact with the ML service
via <a href="https://grpc.io/">gRPC</a>, while integration testing with <a href="https://github.com/mrkn/pycall.rb">PyCall</a>.
Not necessary, but I‚Äôm very happy with the setup.</p>

<h2 id="unexpected-challenges">Unexpected Challenges</h2>

<p>These following challenges have contributed to erroneous line predictions:</p>

<ol>
  <li>Umbrellas. Not a head but still a person.</li>
  <li>Shadows. Around noon there can be some strong shadows resembling people.</li>
  <li>Winter Darkness. It gets much darker much sooner in November and December. Yet the model was trained predominantly with images of people in daylight.</li>
  <li>Winter Snow. Training data never had snow, and now we have mistakes like this:</li>
</ol>

<p><img src="/public/images/count/snownotpeople.jpg" alt="Count Mistaking Snow" width="500px" /></p>

<p>As I discover more of these scenarios, I‚Äôll know what data to gather for a model retraining.</p>

<h2 id="check-out-the-site-and-the-source">Check out <a href="https://count.dimroc.com">the site</a> and the <a href="https://github.com/dimroc/counting_company">source</a>.</h2>

<p><em>Feel free to drop a line below if you have any questions.</em></p>

<h3 id="references">References</h3>

<ul>
  <li>Multi-scale Convolutional Neural Networks for Crowd Counting
Lingke Zeng, Xiangmin Xu, Bolun Cai, Suo Qiu, Tong Zhang
<a href="https://arxiv.org/abs/1702.02359">Page</a> <a href="https://arxiv.org/pdf/1702.02359.pdf">PDF</a></li>
  <li>Fully Convolutional Crowd Counting On Highly Congested Scenes
Mark Marsden, Kevin McGuinness, Suzanne Little and Noel E. O‚ÄôConnor
<a href="https://arxiv.org/pdf/1612.00220.pdf">PDF</a></li>
  <li>Multi-Source Multi-Scale Counting in Extremely Dense Crowd Images
Haroon Idrees, Imran Saleemi, Cody Seibert, Mubarak Shah
IEEE International Conference on Computer Vision and Pattern Recognition (CVPR), 2013
<a href="http://crcv.ucf.edu/papers/cvpr2013/Counting_V3o.pdf">PDF</a></li>
  <li>From Semi-Supervised to Transfer Counting of Crowds
C. C. Loy, S. Gong, and T. Xiang
in Proceedings of IEEE International Conference on Computer Vision, pp. 2256-2263, 2013 (ICCV)
<a href="http://personal.ie.cuhk.edu.hk/~ccloy/files/iccv_2013_crowd.pdf">PDF</a> <a href="http://personal.ie.cuhk.edu.hk/~ccloy/project_semi_counting/index.html">Project Page</a></li>
</ul>
-->
      <!--<a class="more" href="/2017/11/19/counting-crowds-and-lines/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2017/04/25/machine-learning-selfies/">
        Automatic Selfie Segmentation and Style Transfer
      </a>
    </h3>

    <span class="post-comments"><a href="/2017/04/25/machine-learning-selfies/#disqus_thread"></a></span>
    <span class="post-date">25 Apr 2017</span>

    <!--<div class="custom summary">-->
      <!--<p><a href="http://xiaoyongshen.me/webpage_portrait/index.html"><em>Inspired by Automatic Portrait Segmentation for Image Stylization</em></a>
and <em><a href="https://github.com/lengstrom/fast-style-transfer">Fast Style Transfer</a></em>.</p>

<p>Selfies are dominating photography, so why not experiment in that space? As I ramp up
on machine learning and neural networks, I apply a technique called object segmentation to my face
with mixed results but a promising future. This is all heavily inspired by the paper
<a href="http://xiaoyongshen.me/webpage_portrait/index.html">Automatic Portrait Segmentation for Image Stylization by Xiaoyong Shen, et al.</a></p>

<video src="/public/videos/allFourOutputUdniePhotoshop.mp4" controls="true" type="video/mp4" poster="/public/images/machine-learning-selfie-segmentation/mlPortraitsAllFour.jpg"></video>

<p>Flow:</p>

<ol>
  <li>Extract frames from video</li>
  <li>Generate matte using <a href="http://xiaoyongshen.me/webpage_portrait/index.html">portrait segmentation</a> on each frame
    <ul>
      <li>Uses pixel level classification between two categories: foreground and background</li>
    </ul>
  </li>
  <li><a href="https://github.com/lengstrom/fast-style-transfer">Style transfer</a> on original frame for cartoon effect</li>
  <li>Cut out foreground by using the matte as a mask on the styled frame</li>
  <li>Composite new video by placing foreground over original video</li>
</ol>

<p>This road was longer than I thought it would be. The standard neural networks that people are introduced to,
referred to as fully connected layers (FC), don‚Äôt suffice with images because it cannot scale up to many pixels.
There are simply too many nodes in the network. Instead, we use the increasingly popular Convolutional Neural Networks
that are particularly good at classifying images. But rather than merely classifying the image as a face,
we want to classify each pixel as either foreground or background.</p>

<p>For this, we use a <a href="https://docs.google.com/presentation/d/10XodYojlW-1iurpUsMoAZknQMS36p7lVIfFZ-Z7V_aY/edit#slide=id.g529579d43_1_292">Fully Convolutional Network</a>
to perform pixelwise predictions: pixels in, pixels out.</p>

<h2 id="convolutional-neural-networks-cnns">Convolutional Neural Networks (CNNs)</h2>

<p>Neural Networks for images. These are connected layers of kernels (or filters) to detect
features that a collection of pixels have, such as edges. Imagine a kernel being a 5x5 matrix of values used
to detect image properties at a specific section, or receptive field. For more information, read
these excellent articles:</p>

<ul>
  <li><a href="https://ujjwalkarn.me/2016/08/11/intuitive-explanation-convnets/">Intuitive Explanation of Convolutional Neural Networks</a></li>
  <li><a href="http://cs231n.github.io/convolutional-networks/">Architecture of Convolutional Neural Networks</a></li>
</ul>

<h2 id="fully-convolutional-networks">Fully Convolutional Networks</h2>

<p>CNNs were predominantly used to classify images. Is it a dog or cat?
Then the problem of object segmentation came, extracting the pixels that make up the dog or cat.
<a href="https://docs.google.com/presentation/d/10XodYojlW-1iurpUsMoAZknQMS36p7lVIfFZ-Z7V_aY/edit#slide=id.g529579d43_1_292">Fully Convolutional Network</a>
solves that problem.</p>

<p><a href="http://xiaoyongshen.me/webpage_portrait/index.html">Xiaoyong Shen, et al.</a> fine-tuned the
reference FCN implementation specifically for portraits, and a reimplementation of that is
what you see in this post. It is called the Portrait FCN.</p>

<h3 id="artifacts">Artifacts</h3>

<p>The matting isn‚Äôt perfect.</p>

<p><img src="/public/images/machine-learning-selfie-segmentation/matte_140.jpg" alt="Matte Imperfections" style="max-width:200px" /></p>

<p>As you can see here, the blotch in the top right is obviously not part of the selfie or the foreground, while the black blotch
in the bottom is part of the foreground.
This is because our Portrait FCN isn‚Äôt doing the best job it could, but there are better solutions out there
already, such as <a href="http://xiaoyongshen.me/webpage_portrait/index.html">Portrait FCN+</a> that uses a fixed
portrait trimap to assist the model when generating the matte.</p>

<p>I plan to take another approach however. More on that in the next experiment.</p>

<h2 id="style-transfer">Style Transfer</h2>

<p>Once we have the foreground, we use <a href="https://github.com/lengstrom/fast-style-transfer">Logan Engstrom‚Äôs style transfer</a> to take the aesthetic from
a painting, like the one shown below, and intelligently apply it to a photo, resulting in a cartoon like effect.
A style reminiscent of <a href="https://www.youtube.com/watch?v=gpDaNqSXxp0">Roger Rabbit</a>.</p>

<p><img src="/public/images/machine-learning-selfie-segmentation/udnie.jpg" alt="Udnie" style="max-width:300px" /></p>

<p><a href="https://www.youtube.com/watch?v=xVJwwWQlQ1o" target="_blank">
  <img src="/public/images/machine-learning-selfie-segmentation/fox_udnie.gif" alt="Fox Udnie" style="max-width:300px" />
</a></p>

<p>Here‚Äôs an example of style transfer on an entire video before matting:</p>

<video src="/public/videos/suit1_scaled.mp4" controls="true" type="video/mp4" style="max-width: 200px" poster="/public/images/machine-learning-selfie-segmentation/suit1_scaled.jpg">
</video>

<h2 id="wrap-up">Wrap Up</h2>

<p>This gave me fantastic exposure to machine learning on media and the world of Convolutional Neural Networks,
I plan to continue experimenting in this space, and even forked over for an external GPU (eGPU):</p>

<p><a href="https://egpu.io/external-gpu-buyers-guide-2017/">eGPU 2017 Comparison</a></p>

<p>Up until now, I‚Äôve been using the amazing <a href="https://www.floydhub.com">Floyd Hub</a>, the Heroku for Deep Learning.
Definitely check it out. Even if you have your own hardware, it‚Äôs great to have some NVidia K80s at your disposal
to speed up experiements.</p>
-->
      <!--<a class="more" href="/2017/04/25/machine-learning-selfies/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2017/04/11/rake-ml-learn-aws-ml-generation-through-rake/">
        rake ml:learn - AWS Machine Learning through rake
      </a>
    </h3>

    <span class="post-comments"><a href="/2017/04/11/rake-ml-learn-aws-ml-generation-through-rake/#disqus_thread"></a></span>
    <span class="post-date">11 Apr 2017</span>

    <!--<div class="custom summary">-->
      <!--<p>Automating the creation of your machine learning (ML) model can allow your
services to evolve over time, automatically. This article assumes you have
used the AWS ML Web Interface or have some understanding of AWS ML.</p>

<p>Ideally, we would have a model that would use Stochastic Gradient Descent
and would learn per query. But when you want a low maintenance solution such
as <a href="https://aws.amazon.com/machine-learning/">AWS ML</a>, that isn‚Äôt an option,
since AWS ML models are immutable by design.</p>

<p>You can, however, retrain a new model and then flip the switch so queries go
to the new endpoint.</p>

<p>In our setup, achieving this requires a classic Extract, Transform, Load or <strong>ETL</strong>. This article
will be focusing on that last step <strong>Load</strong>. And the hardest step in the AWS ML <strong>load</strong>:
Creating Data Sources.</p>

<p>Before we talk about <strong>load</strong> though, let‚Äôs set up a simple extract and transform
so we all have contexa and are on the same page.</p>

<h2 id="extract">Extract</h2>

<ul>
  <li>Specific to your business logic</li>
  <li>Can be skipped in this simple example and fed directly into the transform</li>
  <li>More complicated examples might require getting data dumps from multiple databases
or other teams</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">Machine</span>
  <span class="k">class</span> <span class="nc">Extractor</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">perform</span>
      <span class="no">CSV</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">"tmp"</span><span class="p">,</span> <span class="s2">"extracted_data.csv"</span><span class="p">),</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">csv</span><span class="o">|</span>
        <span class="no">ImportantData</span><span class="p">.</span><span class="nf">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">data</span><span class="o">|</span>
          <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="nf">to_csv</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="transform">Transform</h2>

<ul>
  <li>Critical step involves converting your raw data into features to be ingested
by AWS Machine Learning models</li>
  <li>What those features are depends on your data and your machine learning model,
whether it be simple linear regression or a deep neural network</li>
  <li>Figuring out features is outside the scope of this article but read <a href="/2017/04/09/machine-learning-who-gave-you-that-long-id/">Machine Learning Long Ids</a>
for some more insight, or better yet, take <a href="https://www.coursera.org/learn/machine-learning">Andrew Ng‚Äôs Machine Learning Course</a></li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">Machine</span>
  <span class="k">class</span> <span class="nc">Transformer</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">"tmp"</span><span class="p">,</span> <span class="s2">"extracted_data.csv"</span><span class="p">))</span>
      <span class="no">Dir</span><span class="p">.</span><span class="nf">mkdir</span><span class="p">(</span><span class="s1">'tmp'</span><span class="p">)</span> <span class="k">unless</span> <span class="no">File</span><span class="p">.</span><span class="nf">exists?</span><span class="p">(</span><span class="s1">'tmp'</span><span class="p">)</span>
      <span class="no">AwsMlTransformer</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"tmp/intermediary.csv"</span><span class="p">).</span><span class="nf">write</span>
      <span class="no">FeatureExpanderWriter</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"tmp/intermediary.csv"</span><span class="p">,</span> <span class="s2">"tmp/features.csv"</span><span class="p">).</span><span class="nf">write</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h1 id="load">Load</h1>

<p>This is the good stuff. Check out the steps listed in the method below and we‚Äôll
walk through each line.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">Machine</span>
  <span class="k">class</span> <span class="nc">Loader</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">"tmp"</span><span class="p">,</span><span class="s2">"features.csv"</span><span class="p">))</span>
      <span class="n">instance</span> <span class="o">=</span> <span class="n">new</span>
      <span class="n">instance</span><span class="p">.</span><span class="nf">upload_data_to_s3</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="n">instance</span><span class="p">.</span><span class="nf">create_data_sources</span>
      <span class="n">instance</span><span class="p">.</span><span class="nf">create_model</span>
      <span class="n">instance</span><span class="p">.</span><span class="nf">create_evaluation</span>
      <span class="n">instance</span><span class="p">.</span><span class="nf">create_realtime_endpoint</span>
    <span class="k">end</span>

    <span class="o">...</span>
</code></pre></div></div>

<p>All of these make use of the AWS SDK v2 for Ruby.</p>

<h2 id="upload-data-to-s3">Upload Data to S3</h2>

<ul>
  <li>AWS ML needs access to your S3 bucket
    <ul>
      <li>This can be done with a bash script as explained <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/granting-amazon-ml-permissions-to-read-your-data-from-amazon-s3.html">on Amazon‚Äôs website</a></li>
      <li>Example below uses <a href="https://aws.amazon.com/cli/">awscli</a>, which can be
installed with <code class="language-plaintext highlighter-rouge">brew install awscli</code></li>
      <li>Replace <code class="language-plaintext highlighter-rouge">dev.machinelearningservice.dimroc.com</code> with your bucket</li>
    </ul>
  </li>
</ul>

<noscript><pre>#!/bin/bash
echo &quot;Granting AWS ML access to S3 bucket dev.machinelearningservice.dimroc.com...&quot;
aws s3api put-bucket-policy --bucket dev.machinelearningservice.dimroc.com --policy file://ml_bucket_policy.json</pre></noscript>
<script src="https://gist.github.com/dimroc/61e1cf2f743a7f5ea0c56bb58dc586d2.js"> </script>

<ul>
  <li>Using the AWS Ruby SDK v2, upload the <code class="language-plaintext highlighter-rouge">features.csv</code> file</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">upload_data_to_s3</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="nb">puts</span> <span class="s2">"uploading </span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> to S3..."</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">data_file</span> <span class="o">=</span> <span class="n">filename</span>

    <span class="n">client</span> <span class="o">=</span> <span class="no">Aws</span><span class="o">::</span><span class="no">S3</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span>
    <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
      <span class="n">client</span><span class="p">.</span><span class="nf">put_object</span><span class="p">(</span>
        <span class="ss">bucket: </span><span class="n">bucket_name</span><span class="p">,</span>
        <span class="ss">key: </span><span class="s2">"uploads/</span><span class="si">#{</span><span class="no">File</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
        <span class="ss">server_side_encryption: </span><span class="s2">"AES256"</span><span class="p">,</span>
        <span class="ss">body: </span><span class="n">f</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div></div>

<h2 id="create-data-sources">Create Data Sources</h2>

<p>This is the hardest step in the <strong>load</strong> stage. If all you read is this section,
you‚Äôll be much better for it.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">create_data_sources</span>
    <span class="nb">puts</span> <span class="s2">"Creating data sources from S3..."</span>

    <span class="c1"># Create Data Source For both Model and Evaluation</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">model_data_source_id</span> <span class="o">=</span> <span class="s2">"learn-mds-</span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">evaluation_data_source_id</span> <span class="o">=</span> <span class="s2">"learn-eds-</span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span>

    <span class="c1"># Training</span>
    <span class="n">ml_client</span><span class="p">.</span><span class="nf">create_data_source_from_s3</span><span class="p">({</span>
      <span class="ss">data_source_id: </span><span class="n">model_data_source_id</span><span class="p">,</span>
      <span class="ss">data_source_name: </span><span class="s2">"Model Source: LearnSample 0-70 </span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
      <span class="ss">compute_statistics: </span><span class="kp">true</span><span class="p">,</span> <span class="c1"># Required to create ML Model</span>
      <span class="ss">data_spec: </span><span class="p">{</span>
        <span class="ss">data_location_s3: </span><span class="n">data_location</span><span class="p">,</span>
        <span class="ss">data_schema: </span><span class="n">data_schema</span><span class="p">.</span><span class="nf">to_json</span><span class="p">,</span> <span class="c1"># More on this below</span>
        <span class="ss">data_rearrangement: </span><span class="n">data_rearrangement</span><span class="p">.</span><span class="nf">to_json</span>
      <span class="p">}</span>
    <span class="p">})</span>

    <span class="n">wait_for_ml</span><span class="p">(</span><span class="ss">:data_source_available</span><span class="p">)</span> <span class="c1"># Block until complete</span>

    <span class="c1"># Evaluation</span>
    <span class="n">ml_client</span><span class="p">.</span><span class="nf">create_data_source_from_s3</span><span class="p">({</span>
      <span class="ss">data_source_id: </span><span class="n">evaluation_data_source_id</span><span class="p">,</span>
      <span class="ss">data_source_name: </span><span class="s2">"Evaluation Source: LearnSample 70-100 </span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
      <span class="ss">compute_statistics: </span><span class="kp">true</span><span class="p">,</span>
      <span class="ss">data_spec: </span><span class="p">{</span>
        <span class="ss">data_location_s3: </span><span class="n">data_location</span><span class="p">,</span>
        <span class="ss">data_schema: </span><span class="n">data_schema</span><span class="p">.</span><span class="nf">to_json</span><span class="p">,</span>
        <span class="ss">data_rearrangement: </span><span class="n">data_rearrangement</span><span class="p">(</span><span class="kp">true</span><span class="p">).</span><span class="nf">to_json</span>
      <span class="p">}</span>
    <span class="p">})</span>

    <span class="n">wait_for_ml</span><span class="p">(</span><span class="ss">:data_source_available</span><span class="p">)</span>
  <span class="k">end</span>
</code></pre></div></div>

<p>The code above performs a few key steps:</p>

<ul>
  <li>Compute statistics
    <ul>
      <li>Necessary to train the ML Model as mentioned in the <a href="http://docs.aws.amazon.com/sdkforruby/api/Aws/MachineLearning/Client.html#create_data_source_from_s3-instance_method">documentation</a></li>
    </ul>
  </li>
  <li>Data Rearragement
    <ul>
      <li>Used when you want to split a data source into two using <code class="language-plaintext highlighter-rouge">complement</code>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">complement</code> tells AWS to split a data source into two, one for training
and one for evaluation. <a href="http://docs.aws.amazon.com/sdkforruby/api/Aws/MachineLearning/Client.html#create_data_source_from_s3-instance_method">Documentation</a>.</li>
          <li>
            <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">data_rearrangement</span><span class="p">(</span><span class="n">complement</span><span class="o">=</span><span class="kp">false</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="ss">splitting: </span><span class="p">{</span>
        <span class="ss">percentBegin: </span><span class="mi">0</span><span class="p">,</span>
        <span class="ss">percentEnd: </span><span class="mi">70</span><span class="p">,</span>
        <span class="ss">strategy: </span><span class="s2">"random"</span><span class="p">,</span>
        <span class="ss">complement: </span><span class="n">complement</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">end</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
      <li><a href="http://docs.aws.amazon.com/machine-learning/latest/dg/data-rearrangement.html">More documentation can be found here</a></li>
    </ul>
  </li>
  <li>Data Schema
    <ul>
      <li>Describes each csv column with AWS Machine Learning metadata. The example below is for a Multiclass Classification Model</li>
      <li>
        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"version"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rowId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rowWeight"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"targetAttributeName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"policy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dataFormat"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CSV"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dataFileContainsHeader"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"attributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"policy"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"CATEGORICAL"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"length"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"NUMERIC"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"base_10"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"NUMERIC"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"digit_1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"NUMERIC"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"digit_2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"NUMERIC"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="nl">"excludedAttributeNames"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div>        </div>
      </li>
      <li><a href="http://docs.aws.amazon.com/machine-learning/latest/dg/creating-a-data-schema-for-amazon-ml.html">More information here</a></li>
    </ul>
  </li>
</ul>

<p>That was a lot. Each section warrants a decent write up, so for not, I recommend
reading the high level information about <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/data-rearrangement.html">data rearrangement</a>
and <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/creating-a-data-schema-for-amazon-ml.html">data schema</a>.</p>

<p>Rest assured though, it‚Äôs far simpler from here on out. The rest is really just API
calls using the IDs you just received.</p>

<h2 id="create-model-from-data-source">Create Model From Data Source</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">create_model</span>
    <span class="nb">puts</span> <span class="s2">"Creating model..."</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">ml_model_id</span> <span class="o">=</span> <span class="s2">"learn-ml-</span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ml_client</span><span class="p">.</span><span class="nf">create_ml_model</span><span class="p">({</span>
      <span class="ss">ml_model_id: </span><span class="n">ml_model_id</span><span class="p">,</span>
      <span class="ss">ml_model_name: </span><span class="s2">"ML model: LearnSample </span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
      <span class="ss">ml_model_type: </span><span class="s2">"MULTICLASS"</span><span class="p">,</span>
      <span class="ss">training_data_source_id: </span><span class="n">model_data_source_id</span><span class="p">,</span>
      <span class="ss">parameters: </span><span class="p">{</span>
        <span class="s2">"sgd.maxPasses"</span> <span class="o">=&gt;</span> <span class="s2">"20"</span><span class="p">,</span>
        <span class="s2">"sgd.shuffleType"</span> <span class="o">=&gt;</span> <span class="s2">"auto"</span>
      <span class="p">}</span>
    <span class="p">})</span>

    <span class="n">wait_for_ml</span><span class="p">(</span><span class="ss">:ml_model_available</span><span class="p">)</span>
  <span class="k">end</span>
</code></pre></div></div>

<h2 id="create-evaluation">Create Evaluation</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">create_evaluation</span>
    <span class="nb">puts</span> <span class="s2">"Creating evaluation..."</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">evaluation_id</span> <span class="o">=</span> <span class="s2">"learn-ev-</span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">ml_client</span><span class="p">.</span><span class="nf">create_evaluation</span><span class="p">({</span>
      <span class="ss">evaluation_id: </span><span class="n">evaluation_id</span><span class="p">,</span>
      <span class="ss">evaluation_name: </span><span class="s2">"Evaluation: LearnSample </span><span class="si">#{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
      <span class="ss">ml_model_id: </span><span class="n">ml_model_id</span><span class="p">,</span>
      <span class="ss">evaluation_data_source_id: </span><span class="n">evaluation_data_source_id</span>
    <span class="p">})</span>

    <span class="n">wait_for_ml</span><span class="p">(</span><span class="ss">:evaluation_available</span><span class="p">)</span>
  <span class="k">end</span>
</code></pre></div></div>
<ul>
  <li>Generates a <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/multiclass-model-insights.html">performance visualization</a></li>
</ul>

<p><img src="/public/images/machine-learning-ids/Multiclass_Model_Insights_-_Amazon_Machine_Learning.jpg" alt="F1 Heat Map" style="max-width:500px;" /></p>

<h2 id="create-realtime-endpoint">Create Realtime Endpoint</h2>

<p>Expose your service!</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">create_realtime_endpoint</span>
    <span class="nb">puts</span> <span class="s2">"Creating realtime endpoint..."</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">ml_client</span><span class="p">.</span><span class="nf">create_realtime_endpoint</span><span class="p">({</span><span class="ss">ml_model_id: </span><span class="n">ml_model_id</span><span class="p">})</span>

    <span class="nb">puts</span> <span class="s2">"Machine Learning Complete! Update your ENV variables with the following:"</span>
    <span class="nb">puts</span>
    <span class="nb">puts</span> <span class="s2">"export AWS_ML_MODEL_ID=</span><span class="si">#{</span><span class="n">ml_model_id</span><span class="si">}</span><span class="s2">"</span>
    <span class="nb">puts</span> <span class="s2">"export AWS_ML_PREDICTION_URL=</span><span class="si">#{</span><span class="n">response</span><span class="p">.</span><span class="nf">realtime_endpoint_info</span><span class="p">.</span><span class="nf">endpoint_url</span><span class="si">}</span><span class="s2">"</span>
    <span class="nb">puts</span>
  <span class="k">end</span>
</code></pre></div></div>

<h1 id="wire-it-all-up-with-rake">Wire it all up with rake</h1>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">namespace</span> <span class="ss">:ml</span> <span class="k">do</span>
  <span class="n">desc</span> <span class="s2">"Transforms raw extracted data into format that's ingestable by AWS Machine Learning"</span>
  <span class="n">task</span> <span class="ss">:transform</span> <span class="o">=&gt;</span> <span class="ss">:environment</span> <span class="k">do</span>
    <span class="no">Machine</span><span class="o">::</span><span class="no">Transformer</span><span class="p">.</span><span class="nf">perform</span>
  <span class="k">end</span>

  <span class="n">desc</span> <span class="s2">"Loads pre transformed data into AWS Machine Learning"</span>
  <span class="n">task</span> <span class="ss">:load</span> <span class="o">=&gt;</span> <span class="ss">:environment</span> <span class="k">do</span>
    <span class="no">Machine</span><span class="o">::</span><span class="no">Loader</span><span class="p">.</span><span class="nf">perform</span>
  <span class="k">end</span>

  <span class="n">desc</span> <span class="s2">"Transform and load raw insurance number policy data into AWS Machine Learning"</span>
  <span class="n">task</span> <span class="ss">:learn</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:transform</span><span class="p">,</span> <span class="ss">:load</span><span class="p">]</span>
<span class="k">end</span>
</code></pre></div></div>

<p>In bash or your scheduled job:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rake ml:learn
</code></pre></div></div>

<p>Run it weekly to keep your machines learning.</p>
-->
      <!--<a class="more" href="/2017/04/11/rake-ml-learn-aws-ml-generation-through-rake/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2017/04/09/machine-learning-who-gave-you-that-long-id/">
        Machine Learning where your long ID comes from
      </a>
    </h3>

    <span class="post-comments"><a href="/2017/04/09/machine-learning-who-gave-you-that-long-id/#disqus_thread"></a></span>
    <span class="post-date">09 Apr 2017</span>

    <!--<div class="custom summary">-->
      <!--<p><em>This article talks about a solution that involved sensitive information.
As a result, all the names and numbers have been replaced with bogus
information.  The concepts are still relevant and applicable.</em></p>

<p>Everyone has an insurance number, and no one knows their actual insurance policy.
Is it car or life insurance? Is it Platinum Shield Standard or Platinum Shield
Plus NY? Bronze or Silver plan?</p>

<p>A client wanted to know and I was fresh out of my <a href="https://www.coursera.org/learn/machine-learning">Machine Learing Class by
Andrew Ng of Stanford and Coursera</a>.
But this had to be low maintenance, so mathematical python code was going to be a stretch.
In came <a href="https://aws.amazon.com/machine-learning/">AWS Machine Learning</a> to save the day.</p>

<h2 id="why-not-just-use-regex">Why not just use Regex?</h2>

<ul>
  <li>Regex might not exist for that particular provider</li>
  <li>Cannot learn and improve over time like a machine learning model</li>
  <li>Still unmanageable working with tens if not hundreds of providers
as opposed to one <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/multiclass-classification.html">Multiclass Classification Model</a></li>
</ul>

<h2 id="how-do-we-machine-learn-a-string">How do we machine learn a string?</h2>

<p><strong>WXY5678</strong> isn‚Äôt the greatest thing to plot, so how do you draw a decision
boundary around it?</p>

<p>I opted to make each digit a dimension, and simply plot that one character in
its own plane. Then rely on the multidimensional power of machine learning
to intuit who the originator was.</p>

<p>Therefore <strong>WXY5678</strong> becomes an array of seven features, a seven dimensional vector:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[W,X,Y,5,6,7,8]
</code></pre></div></div>

<p>We can‚Äôt plot <strong>W</strong> though can we? Yes we can, by translating [0-9A-Z] to be
a number from 0-35, essentially using our numbers as base 36.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[32,33,34,5,6,7,8]
</code></pre></div></div>

<h2 id="starting-with-the-first-digit-one-dimension">Starting with the first digit: one dimension</h2>

<p><img src="/public/images/machine-learning-ids/firstDigitTwoPolicies.png" alt="First Digit - Two" />
<em><a href="https://www.gnu.org/software/octave/">Octave Plot</a> of the first digit for two policies</em></p>

<p>Here we have plotted the first digit of two policies for one thousand numbers,
and the pattern is obvious. A simple linear regression would yield the following split:</p>

<p><img src="/public/images/machine-learning-ids/firstDigitTwoPoliciesLinearRegression.png" alt="First Digit - Two" /></p>

<p>We can now confidently (&gt;90%) predict the policy just based on the first digit.
We take this concept and extrapolate it in two directions:</p>

<ol>
  <li>Add more policies, and therefore more classes (different colored dots)</li>
  <li>Add more digits, and therefore more dimensions</li>
</ol>

<h2 id="more-policies-more-classes">More policies, more classes</h2>

<p><img src="/public/images/machine-learning-ids/firstDigitThreePolicies.png" alt="First Digit - Three" /></p>

<p>The yellow bar is actually a third policy, and notice that it‚Äôs hardcoded to
one value, resulting in a point cloud so thick, it looks like a line.
Again, we can easily intuit this policy from the others with high confidence,
with just the first digit.</p>

<p>Will our luck continue as we add more policies?</p>

<p><img src="/public/images/machine-learning-ids/firstDigitManyPolicies.png" alt="First Digit - Many" /></p>

<p><strong>No.</strong></p>

<p>Above, you‚Äôll see a plot of just eight policies among the hundred we‚Äôre trying
to classify. You can see that patterns start falling apart.</p>

<p>But don‚Äôt lose hope. We have many more digits to go, and that‚Äôll help us draw
confident decision boundaries around certain policies. It‚Äôll just be in
20D. Do they have glasses for that?</p>

<h2 id="more-digits-more-dimensions">More digits, more dimensions</h2>

<p>Imagine 20 features, one per digit, all collaborating to isolate the pattern.</p>

<p>Visualizing three dimensions can get trippy, so twenty plus is unrealistic.
As such, we place our trust in math and our test set that the combination of
these dimensions will yield confident answers.</p>

<p>Visualizing such high dimensions involves <a href="https://en.wikipedia.org/wiki/Dimensionality_reduction">dimensionality reduction</a>
and is not something I did for this project.</p>

<h2 id="other-features">Other Features</h2>

<p><img src="/public/images/machine-learning-ids/ParachuteInsuranceNumbersExpandedFeatureList.jpg" alt="Features Spreadsheet" /></p>

<p>Just for good measure, I added the additional features of number length and base 10.
Policy numbers vary in length based on who issued them, so just another
dimension for us to draw decision boundaries for. The base 36 number as
base 10 was an experimented that yielded little return.</p>

<h2 id="final-outcome">Final Outcome</h2>

<p><img src="/public/images/machine-learning-ids/PredictionHeatMap.jpg" alt="Heat Map" />
<em>AWS Machine Learning Evaluation</em></p>

<p>Above, you can see ten of the hundred policies plotted in a score matrix.
The blue boxes descending diagonally indicate correct predictions and show
this has been pretty successful. The F1 Score for the first row is 92% while
the accuracy (not shown) is 99.5%. Not bad!</p>

<p>The two red boxes above might give cause for concern but the mistaken predictions
all belonged to the correct company, just a different plan.
The service is tasked with showing the top three predictions, so the correct
prediction will appear second rather than first, something the service can
live with.</p>

<h3 id="policy-predictor">Policy Predictor</h3>

<p><img src="/public/images/machine-learning-ids/Parachute_Policy_Predictor.jpg" alt="Prediction Searcher" /></p>

<p>And there you have it, machine learned predictions at your fingertips.</p>

<p>Be sure to check out <a href="/2017/04/11/rake-ml-learn-aws-ml-generation-through-rake/">my post tying this into Rails and Rake for easy model
retraining with <code class="language-plaintext highlighter-rouge">rake ml:learn</code></a>.
After that, it‚Äôll be on to TensorFlow.</p>
-->
      <!--<a class="more" href="/2017/04/09/machine-learning-who-gave-you-that-long-id/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2017/02/03/video-depth-maps/">
        Video Depth Maps, Zed and NVDA
      </a>
    </h3>

    <span class="post-comments"><a href="/2017/02/03/video-depth-maps/#disqus_thread"></a></span>
    <span class="post-date">03 Feb 2017</span>

    <!--<div class="custom summary">-->
      <!--<p>My latest experiment has been to generate video depth maps with the goal of splicing in 3D content.</p>

-->
      <!--<a class="more" href="/2017/02/03/video-depth-maps/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/11/17/changes-your-day-to-day-booklist/">
        Books Worth Reading 2015, 2016
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/11/17/changes-your-day-to-day-booklist/#disqus_thread"></a></span>
    <span class="post-date">17 Nov 2016</span>

    <!--<div class="custom summary">-->
      <!--<ul>
  <li><a href="https://smile.amazon.com/Never-Split-Difference-Negotiating-Depended-ebook/dp/B014DUR7L2">Never split the difference</a></li>
  <li><a href="https://smile.amazon.com/Crossing-Chasm-3rd-Disruptive-Mainstream-ebook/dp/B00DB3D81G/ref=sr_1_1_ha?s=digital-text&amp;ie=UTF8&amp;qid=1486170416&amp;sr=1-1&amp;keywords=crossing+the+chasm">Crossing the Chasm</a></li>
  <li><a href="https://smile.amazon.com/dp/B002YKOX8Y/ref=dp-kindle-redirect?_encoding=UTF8&amp;btkr=1">Unfolding the Napkin</a></li>
  <li><a href="https://smile.amazon.com/Power-Habit-What-Life-Business-ebook/dp/B0055PGUYU/ref=sr_1_1_ha?s=digital-text&amp;ie=UTF8&amp;qid=1486170470&amp;sr=1-1&amp;keywords=the+power+of+habit">The Power of Habit</a></li>
  <li><a href="http://www.sensible.com/dmmt.html">Don‚Äôt make me think</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiohP2Cj_XRAhVGjVQKHZ7SDcsQFggdMAA&amp;url=https%3A%2F%2Fwww.amazon.com%2FInnovators-Dilemma-Revolutionary-Change-Business%2Fdp%2F0062060244&amp;usg=AFQjCNEIyxzX0ZSrnjggDE3ebSZ7CaPIjA&amp;sig2=Psw15PsCyx11rBnMsJvUGg&amp;bvm=bv.146094739,d.cGw">Innovator‚Äôs Dilemma</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=4&amp;cad=rja&amp;uact=8&amp;sqi=2&amp;ved=0ahUKEwiAiMyPjvXRAhVO1WMKHbm0C1sQFgg1MAM&amp;url=https%3A%2F%2Fwww.amazon.com%2FHow-Win-Friends-Influence-People%2Fdp%2F8183220630&amp;usg=AFQjCNH6xyNDp6ubOPJUIoOWOhtF4kXsUA&amp;sig2=mpHQqRXB14sdg2ePsuRESA&amp;bvm=bv.146094739,d.cGc">How to win friends and influence people</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;sqi=2&amp;ved=0ahUKEwiwmOiXjvXRAhUX2WMKHX-SAkcQFggaMAA&amp;url=https%3A%2F%2Fwww.amazon.com%2FNever-Eat-Alone-Expanded-Updated%2Fdp%2F0385346654&amp;usg=AFQjCNH0vtzdALLCqD2DNH9Q7lc4x0DHnQ&amp;sig2=3Tn3Gq2EDPB7l_KXh9lMrg&amp;bvm=bv.146094739,d.cGc">Never eat alone</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiLvK39jvXRAhVls1QKHbOhC14QFggaMAA&amp;url=https%3A%2F%2Fwww.amazon.com%2FZero-One-Notes-Startups-Future%2Fdp%2F0804139296&amp;usg=AFQjCNGBysSIB5wiWeQYRRxFa55mcVidNg&amp;sig2=Vdn0VIhRrBBYMXDZUD56IA&amp;bvm=bv.146094739,d.cGw">Zero to One</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiGm6Okj_XRAhXJqFQKHeznCA8QFggaMAA&amp;url=https%3A%2F%2Fwww.amazon.com%2FHard-Thing-About-Things-Building%2Fdp%2F0062273205&amp;usg=AFQjCNGAu-AtEJavtjqv_IXlGfihQk0E_g&amp;sig2=XjajmByLrQuJcZTF42IiQg&amp;bvm=bv.146094739,d.cGw">The Hard Thing About Hard Things</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwis0t6qj_XRAhWjslQKHXEUDE8QFggaMAA&amp;url=https%3A%2F%2Fwww.amazon.com%2FLiars-Poker-Norton-Paperback-Michael%2Fdp%2F039333869X&amp;usg=AFQjCNHcXHwh6ChBGkZYI_8sYdyJ7xTzdA&amp;sig2=3rgzIAdXOsBavZz8zecFKg&amp;bvm=bv.146094739,d.cGw">Liar‚Äôs Poker</a></li>
  <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwj3u-Wyj_XRAhVhjVQKHcedCS8QFggaMAA&amp;url=https%3A%2F%2Fwww.amazon.com%2FWriting-10th-Anniversary-Memoir-Craft%2Fdp%2F1439156816&amp;usg=AFQjCNH0e-rpB55glCv5EzKX-NwqP4P0eA&amp;sig2=aGhfQR8wrW7zAz1hqnpQOg&amp;bvm=bv.146094739,d.cGw">On Writing: Stephen King</a></li>
  <li><a href="http://www.barnesandnoble.com/w/the-elements-of-style-william-strunk/1116794279?ean=9780205309023&amp;pcta=n&amp;st=PLA&amp;sid=BNB_DRS_Core+Shopping+Textbooks_00000000&amp;2sid=Google_&amp;sourceId=PLGoP164&amp;k_clickid=3x164">The Elements of Style: Strunk and White</a></li>
</ul>
-->
      <!--<a class="more" href="/2016/11/17/changes-your-day-to-day-booklist/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/02/28/using-apis-to-beat-wallstreet-estimates/">
        Using Twitter API to beat the (Wall) Street
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/02/28/using-apis-to-beat-wallstreet-estimates/#disqus_thread"></a></span>
    <span class="post-date">28 Feb 2016</span>

    <!--<div class="custom summary">-->
      <!--<p>I made a killer trade the other day. And it came from a buy signal on a side project. It showed me that Instagram was cannibalizing Twitter image traffic over time. Let me walk you through it.</p>

<h2 id="tweet-farmer">Tweet Farmer</h2>

<p>I‚Äôve been farming tweets from cities for years now. They‚Äôve spun out into experimental projects like <a href="/2015/12/29/search-across-cities/">Urban Events</a> and
<a href="/2014/09/24/tweets-as-pixels/">New Tweet City</a>. When investigating Twitter media, it became apparent that many tweets
were actually links to Instagram (IG).</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/HunterEliteGene">@HunterEliteGene</a> And your favorite level?</p>&mdash; Minibar Austin (@MinibarAustin) <a href="https://twitter.com/MinibarAustin/status/703329275970244611">February 26, 2016</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>In JSON</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "id": 703309386622615600,
  "text": "I captured every level of drunk last night üì∑üç∫ @ 6th Street, Austin, TX https://t.co/ZEspPWrfPR",
  "source": "&lt;a href=\"http://instagram.com\" rel=\"nofollow\"&gt;Instagram&lt;/a&gt;",
  "entities": {
    "urls": [{
        "url": "https://t.co/ZEspPWrfPR",
        "display_url": "instagram.com/p/BCQx8Z3gNiC/" //Important!
      }]
  }
}
</code></pre></div></div>

<p>This tweet, despite being all text, has a URL and contains media at the end of the tunnel. So I grabbed the Instagram image
and reclassified the tweet as <code class="language-plaintext highlighter-rouge">image</code> in my system:</p>

<div style="text-align: center;">
  <img src="/public/images/twitterbeatdastreet/LevelOfDrunk.jpg" alt="Level Of Drunk" width="200px" style="display:inline-block;" />
</div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "id":"703309386622615553",
  "mediaType":"image", *Important*
  "mediaUrl":"https://scontent.cdninstagram.com/t51.2885-15/s640x640/sh0.08/e35/12724735_1711188682429506_1029304848_n.jpg?ig_cache_key=MTE5MzY3MzU1NjQ3NTU2NjIxMA%3D%3D.2.l", //instagram
  "text":"I captured every level of drunk last night üì∑üç∫..."
}
</code></pre></div></div>

<h2 id="how-many-images-were-actually-instagram">How many Images were actually Instagram?</h2>

<p>I had to know. Fortunately, all my tweets lived in <a href="https://www.elastic.co/">Elasticsearch</a>, which has a data visualization
tool called <a href="https://www.elastic.co/products/kibana">Kibana</a>.
I charted the number of <code class="language-plaintext highlighter-rouge">media</code> tweets that were actually Instagram links per city.
Let‚Äôs start with a look at New York City below:</p>

<p><img src="/public/images/twitterbeatdastreet/TwitterNycImagesStacked.jpg" alt="Twitter NYC Stacked" /></p>

<p>Man, that‚Äôs a lot of Instagram. Let‚Äôs check it out as a percentage.</p>

<p><img src="/public/images/twitterbeatdastreet/TwitterNycMediaSplit.jpg" alt="Twitter NYC Percentage" /></p>

<p>Peaked at 92%! So here‚Äôs where I give you the disclaimer about which tweets I‚Äôm analyzing.
<strong>This is only applicable to geotagged tweets with media.</strong> After all, if it‚Äôs not geotagged I can‚Äôt tell if it‚Äôs coming out of NYC.</p>

<p>Let‚Äôs take a look at some other cities:</p>

<p><img src="/public/images/twitterbeatdastreet/TwitterMediaOriginSplitsStacked.jpg" alt="Twitter Cities Percentage" /></p>

<p>Shout out to LA for <strong>only having 64% of traffic from Instagram</strong>. So on Twitter‚Äôs best day, it only had 36% of images on
its own platform.</p>

<p><img src="/public/images/twitterbeatdastreet/Bruh.jpeg" width="300px" alt="Bruh" /></p>

<h2 id="how-did-wall-street-come-in">How did Wall Street come in?</h2>

<p>I‚Äôve been getting fleeced by the <a href="https://www.google.com/finance?q=TWTR&amp;ei=rxbTVvGnLNaNmAGo2q64Ag">TWTR</a> stock for a while now, <strong>even while having this knowledge months ago.</strong>
I knew of this in the Summer of 2015, <strong>when TWTR was $51 (it‚Äôs now $17)</strong>, and did nothing. I was reluctant to use the Twitter API as a buy or sell signal
on the stock. My finance world and my development world were completely distinct. And then this happened.</p>

<p><img src="/public/images/twitterbeatdastreet/VennEpiphany.jpg" alt="Venn Epiphany" style="max-width: 400px; width: 100%;" /></p>

<p>It seems obvious now, but I never went into my side projects to discover signals. Looking at the information, the perfect trade
would have been a pair trade shorting TWTR and buying FB (owner of Instagram). But I felt I had missed the boat on TWTR. I actually hadn‚Äôt,
but I‚Äôve been burned by bottom fishing before and I wasn‚Äôt going to do that again. Not me, no sir.</p>

<p>Then in January, I landed on this <a href="http://blog.business.instagram.com/post/128686033016/150909-advertisinglaunch">nugget of information about Instagram</a>:</p>

<blockquote>
  <p>We‚Äôre excited to announce that starting this month, advertisers both large and small can run campaigns on Instagram. In addition, ads are now available in more than 30 new countries‚Äîincluding Italy, Spain, Mexico, India and South Korea‚Äîand will be launching in markets around the world on Sept. 30.</p>
</blockquote>

<p>September 30th 2015. This means that <a href="http://investor.fb.com/releasedetail.cfm?ReleaseID=952040">FB Q4 Earnings</a>, released in January, would be the first earnings release with IG ad revenue for a full quarter.
My, my are the stars aligning! Couple this with some napkin math on their estimates (<strong>translation</strong>: pure speculation), I was going in for the buy.</p>

<h2 id="buying-options-for-leverage">Buying options for leverage</h2>

<p><img src="/public/images/twitterbeatdastreet/FBOptionConfirmation.jpg" alt="Facebook Options Confirmation" /></p>

<p>It‚Äôs not a game anymore. The options had a strike price of $99 and cost me just under $900 (that‚Äôs all I risked, I know, don‚Äôt tell me about it).</p>

<p>When the market bell closed on the 28th, <a href="https://www.google.com/finance?q=NASDAQ%3AFB&amp;ei=shbTVuHoJpazmAGNw5HQBQ">FB</a> stock dipped to $94.50. GG y‚Äôall, üçª, this was fun.</p>

<p>And then earnings were released. It spiked up to as high as $112. I waited until the next morning and I was out of there:</p>

<p><img src="/public/images/twitterbeatdastreet/FacebookCallOptionsBOOM.jpg" alt="Facebook Call Options BOOM" /></p>

<p>Exercising 300 FB shares became $32,748, I got my first margin call and needed to shore up some cash. I just dumped the shares
and took home a profit of around $3k, just over 300% of the initial ~$900.</p>

<h2 id="dont-forget-the-context">Don‚Äôt forget the context!</h2>

<p>Remembering the context of all this is important. Before 2016, Twitter‚Äôs outlook wasn‚Äôt so bleak. In December 2014, a Twitter exec threw this <a href="http://fortune.com/2014/12/11/twitter-evan-williams-instagram/">jab</a></p>

<blockquote>
  <p>Twitter co-founder Evan Williams: ‚ÄòI don‚Äôt give a shit‚Äô if Instagram has more users</p>
</blockquote>

<p>Now add a finding that claims a majority of your <code class="language-plaintext highlighter-rouge">image</code> traffic belongs to your rival. Perhaps they‚Äôll say Twitter has
always been about the 140 character tweet. After pushing <a href="http://money.cnn.com/2015/10/06/technology/twitter-moments/">Moments</a>, unlikely.</p>

<h2 id="all-of-that-for-only-3k">All of that for only $3K</h2>

<p>It was by far the surest I had ever been that a stock would pop on earnings, and I was timid. I needed some Wolf of Wall Street that day
and I didn‚Äôt have it. But you always say that after a successful trade. It was a great experience and I‚Äôm hoping that the stars
will align again, but I‚Äôve accepted that it might not happen for months, quarters, or even years.</p>
-->
      <!--<a class="more" href="/2016/02/28/using-apis-to-beat-wallstreet-estimates/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/02/05/not-quite-utopia-golang-isomorphic-react/">
        Not Quite Utopia: Golang and isomorphic React
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/02/05/not-quite-utopia-golang-isomorphic-react/#disqus_thread"></a></span>
    <span class="post-date">05 Feb 2016</span>

    <!--<div class="custom summary">-->
      <!--<p>Below are the notes taken when developing my first Golang + React JS application:
<a href="http://urbanevents.dimroc.com/?q=tattoos">Cross City Search</a>.</p>

<p>Notes:</p>

<ul>
  <li>Productivity just isn‚Äôt there</li>
  <li>Boilerplate takes forever
    <ul>
      <li>Both the golang and react ecosystems are in flux.</li>
      <li>What‚Äôs best practice this year will be abandonware next year.</li>
    </ul>
  </li>
  <li>Client siding routing with react-router is extremely time consuming
    <ul>
      <li>Gets even harder when you add redux, but redux-simple-router helps</li>
      <li>Difficulty bumps up another level when you run into bugs rendering js server side.</li>
      <li>Good luck debugging javascript rendered in duktape on golang.</li>
    </ul>
  </li>
  <li>Isomorphic javascript starts off great, falls apart when half the client libraries you need require the <code class="language-plaintext highlighter-rouge">window</code> object
    <ul>
      <li>Bye bye bootstrap and a lot of other loved css frameworks.</li>
    </ul>
  </li>
  <li>I love css modules and the ability to scope your styles.</li>
  <li>On the flipside, I have mixed feelings about coupling everything in a component together: view, style, and logic live in the component/my-component folder.</li>
  <li>Build configurations became pretty sophisticated despite Golang‚Äôs amazing compiler
    <ul>
      <li>Used fancy cross compilation to prepare binaries for docker.</li>
      <li>Had to roll that back for part of the app (cityweb) because we had native dependencies (go-duktape)</li>
      <li>Webpack, the client side pipeline, was quiet a chore to set up, although there was a learning curve there.</li>
      <li>Ended up using make files to create one liners to build go, build the docker image, and then push created image.</li>
    </ul>
  </li>
</ul>

<p>My top goal is to be productive, even if it‚Äôs at the cost of peformance.
Golang and React JS is about as fast as it gets, but they lack the tooling and the frameworks
needed to make them competive in the realms of productivity.</p>

<p>My next project will be using the PEEP stack: Postgres, Elixir, Ember, Phoenix.
I hope this stack will hit the sweet spot of performance and productivity.</p>
-->
      <!--<a class="more" href="/2016/02/05/not-quite-utopia-golang-isomorphic-react/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/01/23/rails-and-angular-without-the-spa/">
        Rails and Angular without the SPA
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/01/23/rails-and-angular-without-the-spa/#disqus_thread"></a></span>
    <span class="post-date">23 Jan 2016</span>

    <!--<div class="custom summary">-->
      <!--<p>A full on Angular single page application (SPA) is overkill 90% of the time.
This article will illustrate a simple way to get the rich user experience from
javascript while still relying on Rails server rendering for the bulk of the application.</p>

<p>Our approach advocates the following philosophy:</p>

<blockquote>
  <p>Javascript and angular functionality exists to enrich the user experience of existing server-side rendered pages.</p>
</blockquote>

<p>This is based on the premise that only a handful of pages actually
need javascript functionality. Most of your pages are happily being rendered server side,
but there‚Äôs that one page that needs sophisticated user experience (UX). For example, you might have
a master-detail page, and want AJAX requests to fill the detail without navigating to a new page.</p>

<h2 id="setting-up-angular-with-rails">Setting up Angular with Rails</h2>

<p>I recommend using <a href="https://github.com/rharriso/bower-rails">bower-rails</a> to manage client side dependencies like Angular.
You will need to install bower, please go to <a href="https://github.com/rharriso/bower-rails">bower-rails</a> for more details if unfamiliar.</p>

<h4 id="bowerfile"><code class="language-plaintext highlighter-rouge">Bowerfile</code></h4>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># A sample Bowerfile</span>
<span class="c1"># Check out https://github.com/42dev/bower-rails#ruby-dsl-configuration for more options</span>

<span class="n">asset</span> <span class="s1">'angular'</span><span class="p">,</span> <span class="s1">'~&gt; 1.4.8'</span></code></pre></figure>

<p>Pull down the client side dependencies</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">rake bower:install bower:clean</code></pre></figure>

<h4 id="then-add-js-files-to-applicationjs">Then add .js files to <code class="language-plaintext highlighter-rouge">application.js</code></h4>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//= require angular/angular</span></code></pre></figure>

<p>Setup is done.</p>

<h3 id="working-with-turbolinks">Working With Turbolinks</h3>

<p>If you‚Äôre using Turbolinks (you should), you‚Äôll need to bootstrap
the angular application on every Turbolinks page load.</p>

<p>I recommend creating an <code class="language-plaintext highlighter-rouge">initializer.js</code> file with the following:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// On turbolinks load:</span>
<span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ready page:load</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">angular</span><span class="p">.</span><span class="nf">bootstrap</span><span class="p">(</span><span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">ltApp</span><span class="dl">'</span><span class="p">])</span>
<span class="p">});</span></code></pre></figure>

<p>This callback will bootstrap angular on every turbolinks page navigation.</p>

<h2 id="angular-directives-and-controllers">Angular Directives and Controllers</h2>

<p>With all our setup done, we can now add Angular functionality to our pages.</p>

<p>There are two main ways to do this:</p>

<ol>
  <li>Angular Controllers
    <ul>
      <li>Useful when adding page specific functionality</li>
    </ul>
  </li>
  <li>Angular Directives
    <ul>
      <li>Useful when creating reusable widgets, such as a HTML 5 video player, that can be reused across pages.</li>
    </ul>
  </li>
</ol>

<h2 id="angular-controllers">Angular Controllers</h2>

<p>Angular let‚Äôs you tag DOM elements with <code class="language-plaintext highlighter-rouge">ng-controller</code> to associate javascript functionality with
a particular page. The key word below being <code class="language-plaintext highlighter-rouge">UserCountsChartCtrl</code>:</p>

<h4 id="usersindexhamlhtml"><code class="language-plaintext highlighter-rouge">users/index.haml.html</code></h4>

<figure class="highlight"><pre><code class="language-haml" data-lang="haml"><span class="nc">.graphs</span><span class="p">{</span><span class="s2">"ng-controller"</span> <span class="o">=&gt;</span> <span class="s2">"UserCountsChartCtrl"</span><span class="p">}</span>
  <span class="nc">.hidden.graph-data</span><span class="p">{</span><span class="ss">data: </span><span class="p">{</span> <span class="s1">'graph-data'</span> <span class="o">=&gt;</span> <span class="vi">@weekly_data</span><span class="p">.</span><span class="nf">to_json</span><span class="p">}</span> <span class="p">}</span>
  <span class="nc">.row</span>
    <span class="nc">.col-md-12</span>
      <span class="nt">%canvas</span><span class="nc">.chart.chart-bar</span><span class="p">{</span><span class="ss">data: </span><span class="s2">"barGraph.data"</span><span class="p">,</span> <span class="ss">labels: </span><span class="s2">"barGraph.labels"</span><span class="p">,</span> <span class="ss">series: </span><span class="s2">"barGraph.series"</span><span class="p">,</span> <span class="ss">options: </span><span class="s2">"barGraph.options"</span><span class="p">}</span></code></pre></figure>

<h4 id="javacsriptsngcontrollersusercountschartctrljs"><code class="language-plaintext highlighter-rouge">javacsripts/ng/controllers/UserCountsChartCtrl.js</code></h4>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nf">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">ltApp</span><span class="dl">'</span><span class="p">).</span>
  <span class="nf">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">UserCountsChartCtrl</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$scope</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">$element</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$element</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">labels</span> <span class="o">=</span> <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">.graph-data</span><span class="dl">'</span><span class="p">).</span><span class="nf">data</span><span class="p">(</span><span class="dl">"</span><span class="s2">graph-data</span><span class="dl">"</span><span class="p">).</span><span class="nx">dates</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">.graph-data</span><span class="dl">'</span><span class="p">).</span><span class="nf">data</span><span class="p">(</span><span class="dl">"</span><span class="s2">graph-data</span><span class="dl">"</span><span class="p">).</span><span class="nx">user_counts</span><span class="p">;</span>

    <span class="c1">// bar graph</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">barGraph</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">labels</span><span class="p">:</span> <span class="nx">labels</span><span class="p">,</span>
      <span class="na">series</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">User Counts</span><span class="dl">"</span><span class="p">],</span>
      <span class="na">data</span><span class="p">:</span> <span class="p">[</span><span class="nx">data</span><span class="p">],</span>
      <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="na">responsive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">maintainAspectRatio</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}]);</span></code></pre></figure>

<p>Here I am drawing bar charts on the index page using <a href="http://www.chartjs.org/">Charts.js</a> with an Angular Controller.</p>

<h3 id="passing-data-from-server-side-to-client-side">Passing data from server side to client side</h3>
<p>One often needs to get information to the javascript client. In a typical SPA, this
is done with a subsequent AJAX call. Here we save that AJAX call and just render the information
in <code class="language-plaintext highlighter-rouge">data</code> HTML attributes. Notice the lines below:</p>

<figure class="highlight"><pre><code class="language-haml" data-lang="haml"><span class="nc">.graphs</span><span class="p">{</span><span class="s2">"ng-controller"</span> <span class="o">=&gt;</span> <span class="s2">"UserCountsChartCtrl"</span><span class="p">}</span>
  <span class="nc">.hidden.graph-data</span><span class="p">{</span><span class="ss">data: </span><span class="p">{</span> <span class="s1">'graph-data'</span> <span class="o">=&gt;</span> <span class="vi">@weekly_data</span><span class="p">.</span><span class="nf">to_json</span><span class="p">}</span> <span class="p">}</span>
  ....</code></pre></figure>

<h4 id="javacsriptsngcontrollersusercountschartctrljs-1"><code class="language-plaintext highlighter-rouge">javacsripts/ng/controllers/UserCountsChartCtrl.js</code></h4>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nf">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">ltApp</span><span class="dl">'</span><span class="p">).</span>
  <span class="nf">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">UserCountsChartCtrl</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$scope</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">$element</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$element</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">labels</span> <span class="o">=</span> <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">.graph-data</span><span class="dl">'</span><span class="p">).</span><span class="nf">data</span><span class="p">(</span><span class="dl">"</span><span class="s2">graph-data</span><span class="dl">"</span><span class="p">).</span><span class="nx">dates</span><span class="p">;</span> <span class="c1">// pull data</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">.graph-data</span><span class="dl">'</span><span class="p">).</span><span class="nf">data</span><span class="p">(</span><span class="dl">"</span><span class="s2">graph-data</span><span class="dl">"</span><span class="p">).</span><span class="nx">user_counts</span><span class="p">;</span>
    <span class="p">...</span></code></pre></figure>

<p>This allows you to leverage Rails (controllers, presenters, etc) to present the data needed by the javascript client side.</p>

<h2 id="angular-directives">Angular Directives</h2>

<p><a href="https://docs.angularjs.org/guide/directive">Angular Directives</a> allow you to create
javascript functionality that is cross cutting. The example below is ensures that
a form can only be submitted once, to stop those pesky double click submissions.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nf">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">ltApp</span><span class="dl">'</span><span class="p">).</span>
    <span class="nf">directive</span><span class="p">(</span><span class="dl">'</span><span class="s1">ltSingleSubmit</span><span class="dl">'</span><span class="p">,</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nf">function </span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">element</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="dl">"</span><span class="s2">submit</span><span class="dl">"</span><span class="p">,</span> <span class="nf">function </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">input[type='submit']</span><span class="dl">"</span><span class="p">).</span><span class="nf">prop</span><span class="p">(</span><span class="dl">'</span><span class="s1">disabled</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">});</span>
      <span class="p">};</span>
    <span class="p">});</span></code></pre></figure>

<p>This can now be easily used in any form:</p>

<figure class="highlight"><pre><code class="language-haml" data-lang="haml">  <span class="p">=</span> <span class="n">simple_form_for</span> <span class="vi">@build</span><span class="p">,</span> <span class="ss">url: </span><span class="n">build_path</span><span class="p">(</span><span class="vi">@build</span><span class="p">),</span> <span class="ss">html: </span><span class="p">{</span> <span class="s2">"lt-single-submit"</span> <span class="o">=&gt;</span> <span class="s1">''</span> <span class="p">}</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
    <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">input</span> <span class="ss">:name</span>
    <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">submit</span> <span class="s1">'Save'</span></code></pre></figure>

<h3 id="relying-on-server-side-rendering">Relying on Server Side Rendering</h3>

<p>When making hybrid applications like this, it‚Äôs easy to get server side
and client side rendering jumbled together. I advocate always using server side rendering.
Sure it‚Äôs less flashy, but it‚Äôs more productive and consolidates your validations into one place.</p>

<p>I‚Äôve done this many ways. We‚Äôll start with the simplest: Angular $http GETs.</p>

<h3 id="ajax-with-angular-http">AJAX with Angular $http</h3>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nf">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">ltApp</span><span class="dl">'</span><span class="p">).</span>
  <span class="nf">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">MarketingShowCtrl</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$scope</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">$element</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">$http</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">turbosafe</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$element</span><span class="p">,</span> <span class="nx">$http</span><span class="p">,</span> <span class="nx">turbosafe</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">.cta</span><span class="dl">"</span><span class="p">).</span><span class="nf">data</span><span class="p">(</span><span class="dl">"</span><span class="s2">path</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Get the path for the GET form the data attribute.</span>

    <span class="c1">// Angular Scope has method fetchCollection used by ng-click.</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">fetchCollection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collectionName</span><span class="p">,</span> <span class="nx">direction</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Start Turbolinks progress bar even though we're using Angular!</span>
      <span class="nx">turbosafe</span><span class="p">.</span><span class="nf">start</span><span class="p">();</span>

      <span class="nx">$http</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="p">{</span><span class="na">params</span><span class="p">:</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="nx">collectionName</span><span class="p">,</span> <span class="na">direction</span><span class="p">:</span> <span class="nx">direction</span><span class="p">}}).</span>
        <span class="nf">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">newDom</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
          <span class="c1">// Replace DOM element with Server Side rendered HTML.</span>
          <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">#top</span><span class="dl">"</span><span class="p">).</span><span class="nf">replaceWith</span><span class="p">(</span><span class="nx">newDom</span><span class="p">);</span>
          <span class="nx">turbosafe</span><span class="p">.</span><span class="nf">stop</span><span class="p">();</span>
        <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">warn</span><span class="p">(</span><span class="dl">"</span><span class="s2">Unable to retrieve collection</span><span class="dl">"</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
          <span class="nx">turbosafe</span><span class="p">.</span><span class="nf">stop</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">};</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haml" data-lang="haml"><span class="p">=</span> <span class="n">link_to</span> <span class="s2">"Next Collection"</span><span class="p">,</span> <span class="s2">"#"</span><span class="p">,</span> <span class="s2">"ng-click"</span> <span class="o">=&gt;</span> <span class="s1">'fetchCollection("$50", "Next")'</span></code></pre></figure>

<h3 id="ajax-with-remote-forms">AJAX with Remote Forms</h3>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">angular</span><span class="p">.</span><span class="nf">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">ltApp</span><span class="dl">'</span><span class="p">).</span>
  <span class="nf">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">AccessTokenCtrl</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$scope</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">$element</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$element</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Handle remote forms success.</span>
    <span class="nx">$element</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">ajax:success</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$element</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">#access_token</span><span class="dl">"</span><span class="p">).</span><span class="nf">html</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">html</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}]);</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-haml" data-lang="haml"><span class="nc">.panel-body</span>
  <span class="nc">.row</span>
    <span class="nc">.col-md-12</span><span class="p">{</span> <span class="s2">"ng-controller"</span> <span class="o">=&gt;</span> <span class="s2">"AccessTokenCtrl"</span><span class="p">}</span>
      <span class="nt">%h3</span><span class="nc">.col-header</span>
      <span class="nf">#access_token</span><span class="p">=</span> <span class="vi">@user</span><span class="p">.</span><span class="nf">live_access_token</span>
      <span class="p">-</span> <span class="c1"># Notice the remote: true to show Rails remote forms.</span>
      <span class="p">=</span> <span class="n">simple_form_for</span><span class="p">(</span><span class="vi">@user</span><span class="p">,</span> <span class="ss">url: </span><span class="n">generate_access_token_account_path</span><span class="p">(</span><span class="ss">mode: :live</span><span class="p">),</span> <span class="ss">remote: </span><span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
        <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">button</span> <span class="ss">:button</span> <span class="k">do</span>
          <span class="nt">%span</span><span class="nc">.glyphicon.glyphicon-refresh</span></code></pre></figure>

<h2 id="wrap-up">Wrap up</h2>

<p>You‚Äôre right, I got carried away at the end. But now you have an exhaustive set of examples
that show how a sprinkle of Angular can breathe rich interactivity into your Rails rendered pages.</p>

<p>Enjoy!</p>
-->
      <!--<a class="more" href="/2016/01/23/rails-and-angular-without-the-spa/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/01/13/machine-learning-neighborhoods/">
        Machine Learning NYC Neighborhoods
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/01/13/machine-learning-neighborhoods/#disqus_thread"></a></span>
    <span class="post-date">13 Jan 2016</span>

    <!--<div class="custom summary">-->
      <!--<p>Check out the <a href="http://machinelearninghoods.dimroc.com">NYC Neighborhood Predictor</a>!
<img src="/public/images/FlyingToCoachellaPrediction.jpg" alt="Prediction Matrix" width="400px" /></p>

<p>It uses <a href="https://aws.amazon.com/machine-learning/">AWS Machine Learning</a> to predict
which neighborhood a string of text originates from.</p>

<h2 id="overview">Overview</h2>

<ul>
  <li>Uses a simple <a href="http://www.phoenixframework.org/">Elixir and Phoenix</a> Web app to expose an
AWS Machine Learning <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/requesting-real-time-predictions.html">Real-Time Endpoint</a>.</li>
  <li><a href="https://github.com/dimroc/machine_learning_hoods">Source Code</a></li>
</ul>

<h2 id="machine-learning-what">Machine Learning What?</h2>

<ul>
  <li>Using a dataset of ~1G of geo-tagged tweets, we create a CSV with two columns: text and neighborhood.</li>
  <li>After training and evaluating a machine learning (ML) model with this data, we expose the real-time endpoint via this elixir application.</li>
</ul>

<h2 id="takeaways">Takeaways</h2>

<ul>
  <li>Molding the training data to create a better model is the real challenge here.</li>
  <li>Does my data even have statistical correlations or is it just noise?</li>
  <li>Iterate, iterate, and iterate again on the model and evaluation data is what needs to be done here.</li>
</ul>

<h3 id="input-schema">Input Schema</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"targetAttributeName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Neighborhood"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dataFormat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CSV"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dataFileContainsHeader"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Text"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TEXT"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attributeName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Neighborhood"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"attributeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CATEGORICAL"</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"excludedAttributeNames"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><img src="/public/images/PredictionMatrix.jpg" alt="Prediction Matrix" />
<img src="/public/images/NeighborhoodCategories.jpg" alt="Neighborhood Categories" /></p>

-->
      <!--<a class="more" href="/2016/01/13/machine-learning-neighborhoods/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/01/10/tutum-cli-to-exec-docker/">
        tutum exec to replace heroku run
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/01/10/tutum-cli-to-exec-docker/#disqus_thread"></a></span>
    <span class="post-date">10 Jan 2016</span>

    <!--<div class="custom summary">-->
      <!--<p><code class="language-plaintext highlighter-rouge">heroku run rails console</code> is an amazing commandline utility enabling one to run a REPL loop on their production server.</p>

<p>Docker comes with an <code class="language-plaintext highlighter-rouge">exec</code> command that allows you to ssh into a running container much like the <code class="language-plaintext highlighter-rouge">heroku run</code> command.
But doing this on a remotely running docker container can be a hassle.</p>

<p>This is now much easier via docker with tutum. See this example with elixir:</p>

<p><img src="/public/images/tutumExec.jpg" alt="Tutum Exec" /></p>
-->
      <!--<a class="more" href="/2016/01/10/tutum-cli-to-exec-docker/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2016/01/01/tutum-to-coordinate-docker-images/">
        Tutum to Coordinate Docker
      </a>
    </h3>

    <span class="post-comments"><a href="/2016/01/01/tutum-to-coordinate-docker-images/#disqus_thread"></a></span>
    <span class="post-date">01 Jan 2016</span>

    <!--<div class="custom summary">-->
      <!--<p>I‚Äôve been using <a href="https://www.tutum.co/">Tutum</a> to manage my docker containers.</p>

<p><img src="/public/images/ServiceDashboardTutum.jpg" alt="Service Dashboard" /></p>

<p>They use <a href="https://github.com/weaveworks/weave">Weave</a>
under the hood so your containers can link across nodes invisibly.</p>

<p>They also have great monitoring:
<img src="/public/images/NewTweetCityTutumNodeCPUOver.jpg" alt="Docker Monitoring" /></p>

<p>Check it out!</p>
-->
      <!--<a class="more" href="/2016/01/01/tutum-to-coordinate-docker-images/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/12/29/search-across-cities/">
        Urban Events: Compare NYC media against LA and other cities
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/12/29/search-across-cities/#disqus_thread"></a></span>
    <span class="post-date">29 Dec 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>Just released <a href="http://urbanevents.dimroc.com/?q=tattoos">Urban Events</a>!</p>

<p><a href="http://urbanevents.dimroc.com/?q=tattoos"><img src="/public/images/UrbanEvents.jpg" alt="Urban Events" /></a></p>

<ul>
  <li>This experiment allows one to search for media across cities and neighborhoods.</li>
  <li>The technology used was Golang, React JS, Webpack, Elasticsearch, and Docker.</li>
</ul>

<h3 id="high-level-services">High Level Services</h3>

<ol>
  <li><strong>City Recorder</strong>: Classifies tweets from Twitter‚Äôs <a href="https://dev.twitter.com/streaming/reference/post/statuses/filter">Public Streaming API</a>
with a neighborhood by running Elasticsearch (ES) Geospatial percolations against an index of
<a href="https://github.com/dimroc/neighborhoods">city neighborhood GeoJSON files</a>.</li>
  <li><strong>City Web</strong>: Searches across cities using Elasticsearch‚Äôs <code class="language-plaintext highlighter-rouge">top_hits</code> metric aggregator and displays results in React JS.</li>
</ol>

<p>Currently listening to NYC, London, Paris, Austin, Miami, and Los Angeles.</p>

<p>Check out the <a href="https://github.com/dimroc/urbanevents">github page</a> for technical details and source code.</p>

-->
      <!--<a class="more" href="/2015/12/29/search-across-cities/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/11/22/go-starter-kit-with-webpack-hmr/">
        Boilerplate for the best of Go and React
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/11/22/go-starter-kit-with-webpack-hmr/#disqus_thread"></a></span>
    <span class="post-date">22 Nov 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>Want in on the killer combo of Golang with React? Check out the <a href="https://github.com/olebedev/go-starter-kit">go-starter-kit</a>.
It‚Äôs a little rough around the edges, but once you get clean up that Makefile you‚Äôll have the following goodness:</p>

<ol>
  <li><a href="http://webpack.github.io/docs/hot-module-replacement.html">Hot Module Replace</a>: <em>It‚Äôs like live reload for every module.</em></li>
  <li>Isomorphic React with <a href="https://github.com/olebedev/go-duktape">go-duktape</a>: Render HTML server side the first time, then client side every subsequent request.</li>
  <li><a href="http://rackt.org/redux/">Redux</a>: An evolution of the <a href="https://facebook.github.io/flux/docs/overview.html">Flux design pattern</a> that‚Äôs since been simplified for reloadability and development.</li>
  <li><a href="https://github.com/webpack/webpack-dev-server">Webpack dev server</a> to hot reload while coding ala live reload off http://localhost:5001</li>
  <li>One terminal window process for all development!</li>
</ol>

<p>I did have to patch up the Makefile to support my usage of the <a href="https://golang.org/doc/code.html#PackagePaths">recommended package paths</a>.</p>

<p>ie: <code class="language-plaintext highlighter-rouge">$GOPATH/src/github.com/user/your_app</code></p>

<h3 id="makefile">Makefile</h3>

<figure class="highlight"><pre><code class="language-makefile" data-lang="makefile"><span class="nv">BIN</span> <span class="o">=</span> <span class="p">$(</span>GOPATH<span class="p">)</span>/bin
<span class="nv">NODE_BIN</span> <span class="o">=</span> <span class="p">$(</span>shell npm bin<span class="p">)</span>
<span class="nv">PID</span> <span class="o">=</span> .pid
<span class="nv">GO_FILES</span> <span class="o">=</span> <span class="p">$(</span>filter-out app/server/bindata.go, <span class="p">$(</span>shell find app <span class="nt">-type</span> f <span class="nt">-name</span> <span class="s2">"*.go"</span><span class="p">))</span>
<span class="nv">BINDATA</span> <span class="o">=</span> app/server/bindata.go
<span class="nv">BINDATA_FLAGS</span> <span class="o">=</span> <span class="nt">-pkg</span><span class="o">=</span>server <span class="nt">-prefix</span><span class="o">=</span>app/server/data
<span class="nv">BUNDLE</span> <span class="o">=</span> app/server/data/static/build/bundle.js
<span class="nv">APP</span> <span class="o">=</span> <span class="p">$(</span>shell find app/client <span class="nt">-type</span> f<span class="p">)</span>
<span class="nv">GO_APP</span> <span class="o">=</span> github.com/dimroc/urbanevents/cityweb/app <span class="c"># Addition: Introduced GO_APP path</span>

<span class="nl">build</span><span class="o">:</span> <span class="nf">clean $(BIN)/app</span>

<span class="nl">clean</span><span class="o">:</span>
	<span class="p">@</span><span class="nb">rm</span> <span class="nt">-rf</span> app/server/data/static/build/<span class="k">*</span>
	<span class="p">@</span><span class="nb">rm</span> <span class="nt">-rf</span> app/server/data/bundle.server.js
	<span class="p">@</span><span class="nb">rm</span> <span class="nt">-rf</span> <span class="p">$(</span>BINDATA<span class="p">)</span>
	<span class="p">@</span><span class="nb">echo </span>cleaned

<span class="nl">$(BUNDLE)</span><span class="o">:</span> <span class="nf">$(APP)</span>
	<span class="p">@$(</span>NODE_BIN<span class="p">)</span>/webpack <span class="nt">--progress</span> <span class="nt">--colors</span>

<span class="nl">$(BIN)/app</span><span class="o">:</span> <span class="nf">$(BUNDLE) $(BINDATA)</span>
	<span class="p">@</span>go <span class="nb">install</span> <span class="p">$(</span>GO_APP<span class="p">)</span> <span class="c"># Swapped in GO_APP instead of app</span>

<span class="nl">kill</span><span class="o">:</span>
	<span class="p">@</span><span class="nb">kill</span> <span class="sb">`</span><span class="nb">cat</span> <span class="p">$(</span>PID<span class="p">)</span><span class="sb">`</span> <span class="o">||</span> <span class="nb">true</span>

<span class="nl">serve</span><span class="o">:</span> <span class="nf">clean $(BUNDLE)</span>
	<span class="p">@</span>make restart
	<span class="p">@$(</span>NODE_BIN<span class="p">)</span>/webpack-dev-server <span class="nt">--config</span> webpack.hot.config.js <span class="nv">$$</span><span class="o">!</span> <span class="o">&gt;</span> <span class="p">$(</span>PID<span class="p">)</span>_wds &amp;
	<span class="p">@</span><span class="nv">ANYBAR_WEBPACK</span><span class="o">=</span>yep <span class="p">$(</span>NODE_BIN<span class="p">)</span>/webpack <span class="nt">--progress</span> <span class="nt">--colors</span> <span class="nt">--watch</span> <span class="nv">$$</span><span class="o">!</span> <span class="o">&gt;</span> <span class="p">$(</span>PID<span class="p">)</span>_wp &amp;
	<span class="p">@</span>fswatch <span class="p">$(</span>GO_FILES<span class="p">)</span> | xargs <span class="nt">-n1</span> <span class="nt">-I</span><span class="o">{}</span> make restart <span class="o">||</span> make <span class="nb">kill</span>
	<span class="p">@</span><span class="nb">kill</span> <span class="sb">`</span><span class="nb">cat</span> <span class="p">$(</span>PID<span class="p">)</span>_wp<span class="sb">`</span> <span class="o">||</span> <span class="nb">true</span>
	<span class="p">@</span><span class="nb">kill</span> <span class="sb">`</span><span class="nb">cat</span> <span class="p">$(</span>PID<span class="p">)</span>_wds<span class="sb">`</span> <span class="o">||</span> <span class="nb">true</span>

<span class="nl">restart</span><span class="o">:</span> <span class="nf">BINDATA_FLAGS += -debug</span>
<span class="nl">restart</span><span class="o">:</span> <span class="nf">$(BINDATA)</span>
	<span class="p">@</span>make <span class="nb">kill</span>
	<span class="p">@</span>go <span class="nb">install</span> <span class="p">$(</span>GO_APP<span class="p">)</span> <span class="c"># Swapped in GO_APP instead of app</span>
	<span class="p">@$(</span>BIN<span class="p">)</span>/app run &amp; <span class="nb">echo</span> <span class="nv">$$</span><span class="o">!</span> <span class="o">&gt;</span> <span class="p">$(</span>PID<span class="p">)</span>

<span class="nl">$(BINDATA)</span><span class="o">:</span>
	<span class="p">$(</span>BIN<span class="p">)</span>/go-bindata <span class="p">$(</span>BINDATA_FLAGS<span class="p">)</span> <span class="nt">-o</span><span class="o">=</span><span class="nv">$@</span> app/server/data/...

<span class="nl">lint</span><span class="o">:</span>
	<span class="p">@</span>eslint app/client <span class="o">||</span> <span class="nb">true</span>
	<span class="p">@</span>golint <span class="p">$(</span>filter-out app/main.go, <span class="p">$(</span>GO_FILES<span class="p">))</span> <span class="o">||</span> <span class="nb">true</span>
	<span class="p">@</span>golint <span class="nt">-min_confidence</span><span class="o">=</span>1 app</code></pre></figure>

-->
      <!--<a class="more" href="/2015/11/22/go-starter-kit-with-webpack-hmr/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/11/14/etl-language-showdown-pt3/">
        ETL Language Showdown Part 3
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/11/14/etl-language-showdown-pt3/#disqus_thread"></a></span>
    <span class="post-date">14 Nov 2015</span>

    <!--<div class="custom summary">-->
      <!--<p><em>This article is a continuation of the <a href="https://en.wikipedia.org/wiki/Extract,_transform,_load">Extract-Transform-Load (ETL)</a> showdown series.
Check these posts out for additional context and check out the <a href="https://github.com/dimroc/etl-language-comparison">repo</a>.</em></p>

<ul>
  <li><em><a href="/2014/09/29/etl-language-showdown/">Comparing Golang, Scala, Elixir and Ruby for ETL</a></em></li>
  <li><em><a href="/2015/05/07/etl-language-showdown-pt2">Comparing Golang, Scala, Elixir, Ruby, and now Python3 for ETL: Part 2</a></em></li>
</ul>

<hr />

<p><em>Analyses and discussions done in this ETL series have led to the following language pull requests:</em></p>

<ol>
  <li><em><a href="https://github.com/erlang/otp/pull/771">Add BIF binary:split/2,3 to Erlang</a></em></li>
  <li><em><a href="https://github.com/golang/go/issues/13288">Improve case insensitive regex in Golang</a></em></li>
</ol>

<hr />

<p>In this post, we will compare a Map Reduce solution to count the number of times <code class="language-plaintext highlighter-rouge">knicks</code>
is mentioned in ~40M tweets spanning multiple files. This originally came about as a way to compare vanilla
<a href="https://en.wikipedia.org/wiki/Global_interpreter_lock">GIL-bound</a> Ruby implementations against Scala
and Golang. It has since evolved into a <a href="https://github.com/dimroc/etl-language-comparison">repo of idiomatic ETL solutions</a>
for a variety of languages (ten at the time of this writing).</p>

<h3 id="langauges-covered">Langauges Covered</h3>

<table>
<tr> <th>Language</th><th>Owner</th> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/ruby">Ruby</a></td><td> </td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/golang">Golang</a></td><td></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/scala">Scala</a></td><td></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/nim">Nim</a></td><td></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/nodejs">Node</a></td><td></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/php">PHP</a></td><td></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/erlang">Erlang</a></td><td><a href="https://github.com/potatosalad">potatosalad</a></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/elixir">Elixir</a></td><td><a href="https://github.com/josevalim">josevalim</a></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/rust">Rust</a></td><td><a href="https://github.com/potatosalad">potatosalad</a></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/python">Python</a></td><td></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/csharp">C#</a></td><td><a href="https://github.com/mganss">mganss</a></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/shell">shell</a></td><td><a href="https://github.com/mganss">mganss</a></td> </tr>
<tr> <td><a href="https://github.com/dimroc/etl-language-comparison/tree/master/perl">perl</a></td><td><a href="https://github.com/sitaramc">sitaramc</a></td> </tr>
</table>

<p><em>Hype up your language by improving the current implementation. Give me a shout by <a href="https://github.com/dimroc/etl-language-comparison/issues">raising an issue</a> to become an owner.</em></p>

<h2 id="shortcuts-led-to-apple-and-orange-comparisons">Shortcuts led to apple and orange comparisons</h2>

<p>During this adventure, my Golang solution wasn‚Äôt as performant as I had hoped because the regex
library couldn‚Äôt compete with Scala‚Äôs. As a result, I introduced the first apple to orange comparison by allowing Golang to use substrings.</p>

<p>One can‚Äôt help but find the fastest solution possible, and this story continued with other languages and pull requests.
Reference implementations were accompanied with optimized solutions taking shortcuts, and I couldn‚Äôt turn away such sweet code.</p>

<p>Even when sticking to the reference solution, it has becoming increasingly difficult to keep the implementations consistent across languages
because certain idioms sway solutions in different directions.</p>

<h3 id="examples-of-shortcuts">Examples of shortcuts</h3>

<ol>
  <li>PHP takes a shortcut by using <code class="language-plaintext highlighter-rouge">stripos</code> that only works on ASCII, not Unicode.</li>
  <li>Regex comparison as opposed to substring checks.</li>
  <li>Loading file contents into memory as opposed to streaming.</li>
  <li>Having the master or supervisor keep track of the results so there is effectively no reduction step.</li>
  <li>Leveraging binary pattern matching as opposed to regular regex.</li>
</ol>

<p>Here are the previous implementations described in <a href="/2015/05/07/etl-language-showdown-pt2/">part 2 of the ETL showdown</a>:</p>

<div height="800px">
  <canvas id="languageChart"></canvas>
</div>

<h1 id="takeaway">Takeaway</h1>

<p>The results have a healthy amount of variety. Going into <a href="/2014/09/29/etl-language-showdown/">part 1</a>, it was believed that
the results of multi-threaded approaches would be the same because the problem would be IO bound. Well, that was wrong.
Instead of using this as a speed comparison across languages, use this repo as a reference for writing idiomatic ETL solutions in the language of your choice.
<a href="https://github.com/dimroc/etl-language-comparison">Check out the repo.</a></p>

<p>In order to promote consistency across implementations, I‚Äôve introduced the following:</p>

<h3 id="rules-of-reference-implementation">Rules of Reference Implementation</h3>

<ol>
  <li>Stream input from files.</li>
  <li>Use Regular Expressions to check for the presence of <code class="language-plaintext highlighter-rouge">knicks</code>.</li>
  <li>Have multiple mappers, but one reducer.</li>
  <li>Each individual worker holds its results in a hash and sends that final hash back for reduction.</li>
</ol>

<h3 id="new-school-language-additions">New School: Language Additions</h3>

<div height="800px">
  <canvas id="languageChart2"></canvas>
</div>

<h2 id="new-school-observations-and-shortcuts">New School Observations and Shortcuts</h2>

<p>We‚Äôve since added even more languages, each with their own nuances.
<a href="http://nim-lang.org/">Nim</a> is a newcomer I‚Äôve never heard of but it performed surprisingly well.
Below you‚Äôll find some notes on each implementation.</p>

<h3 id="erlang"><a href="https://github.com/dimroc/etl-language-comparison/tree/master/erlang">Erlang</a></h3>

<ol>
  <li>Leverages <a href="http://www.erlang.org/doc/efficiency_guide/binaryhandling.html">Binary Pattern Matching</a>.</li>
  <li>Holds all data in memory as opposed to streaming input line by line.</li>
</ol>

<h3 id="nim"><a href="https://github.com/dimroc/etl-language-comparison/tree/master/nim">Nim</a></h3>

<ol>
  <li>Implementation seems identical to the ruby version (streaming input with regex but using multiple cores) and it is blazing fast. The first I‚Äôve heard of <a href="http://nim-lang.org/">Nim</a>.</li>
</ol>

<h3 id="rust"><a href="https://github.com/dimroc/etl-language-comparison/tree/master/rust">Rust</a></h3>

<ol>
  <li>Regex solution is identical to reference implementation.</li>
  <li>Substring solution only deals with ASCII.</li>
  <li>Man is it fast. Would love someone to take another look at the Rust implementation to see how it might be taking shortcuts against the reference implementation.</li>
</ol>

<h3 id="php"><a href="https://github.com/dimroc/etl-language-comparison/tree/master/php">PHP</a></h3>

<ol>
  <li>Only doing substring checks against ASCII.</li>
  <li>Single threaded.</li>
  <li>Included just to grow the library of implementations. Improvements and pull requests are welcome.</li>
</ol>

<h3 id="node-js"><a href="https://github.com/dimroc/etl-language-comparison/tree/master/nodejs">Node JS</a></h3>

<ol>
  <li>Uses <a href="https://nodejs.org/api/cluster.html">cluster</a> to get around the <a href="https://en.wikipedia.org/wiki/Global_interpreter_lock">Global Interpreter Lock (GIL)</a>.</li>
  <li>The workers communicate a match to the cluster master, effectively skipping the reduction step.</li>
</ol>

<h2 id="call-to-action">Call To Action</h2>

<ul>
  <li>The number of languages being covered has grown past my ability to maintain. If you would like to <strong>own</strong> a particular language‚Äôs implementation,
please let me know and feel free to submit PR‚Äôs my way.</li>
  <li>Another area of interest is memory consumption. Tracking memory consumption can be tricky.
For example, runtimes can aggresssively grab memory despite the application not using all of it. It would
be great to track peak memory usage for the runs, so that we can now plot memory consumption along with execution time.</li>
</ul>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>

<script>
(function() {
    var options = {
      maintainAspectRatio: true,
      responsive: true
    };

    var results = {
      "ruby": 31.426,
      "ruby-parallel": 7.602,
      "jruby": 12.915,
      "elixir": 10.959,
      "go-substring": 6.040,
      "go-regex": 18.637,
      "python3-pool": 7.331,
      "scala-akka": 8,
      "scala-parallel": 8.5,
      "scala-future": 8.5,
    };

    var results2 = {
      "ruby": 31.426,
      "nim": 2.813,
      "nodejs-cluster": 2.582,
      "php-ascii-single-thread": 10.901,
      "erlang-unsafe-cheats": 2.589,
      "erlang-binary": 4.081,
      "erlang-regex": 5.874,
      "rust-substring": 1.960,
      "rust-regex": 1.382
    };

    function createBarChart(results, canvasId) {
      var data = {
          labels: $.map(results, function(key, element) { return element }),
          datasets: [ { data: $.map(results, function(key, element) { return key }) } ]
      };

      var ctx = document.getElementById(canvasId).getContext("2d");
      var myBarChart = new Chart(ctx).Bar(data, options);
    }

    createBarChart(results, "languageChart");
    createBarChart(results2, "languageChart2");

})();
</script>

-->
      <!--<a class="more" href="/2015/11/14/etl-language-showdown-pt3/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/08/20/cross-compiled-go-with-docker/">
        Cross Compiled Go with Alpine Linux make a tiny Docker image
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/08/20/cross-compiled-go-with-docker/#disqus_thread"></a></span>
    <span class="post-date">20 Aug 2015</span>

    <!--<div class="custom summary">-->
      <!--<p><em>Update: Docker has since released <a href="https://docs.docker.com/develop/develop-images/multistage-build/">Multi-stage builds</a>
to address the problem described below. It‚Äôs a far better solution, and you can consider the below article deprecated.
Check it out!</em></p>

<p>Golang‚Äôs ability to create a self-contained executable makes deployment a breeze.
You just copy the single file. No need to worry about versioned dependencies and your dependencies‚Äô dependencies.</p>

<p>Golang‚Äôs compiler goes ever further by supporting <a href="http://stackoverflow.com/questions/12168873/cross-compile-go-on-osx">cross compilation</a>.
Know your target architecture?
Compile directly for it from your dev box. Linux example below:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">brew <span class="nb">install </span>go <span class="nt">--with-cc-common</span> <span class="c"># Installs go with cross compilation support</span>
<span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span>amd64 go build <span class="nt">-o</span> someexecutable</code></pre></figure>

<p>Couple this with a minimalist docker image, such as <a href="https://github.com/gliderlabs/docker-alpine">alpine</a>, and you have yourself a tiny 40MB image.</p>

<h4 id="dockerfile">Dockerfile</h4>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">FROM alpine:3.2
ADD someexecutable /go/bin/someexecutable
ENTRYPOINT /go/bin/someexecutable</code></pre></figure>

<p>Sometimes you‚Äôll need an extra thing or two, like CA certificates to connect to HTTPS with SSL:</p>

<h4 id="dockerfile-1">Dockerfile</h4>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">FROM alpine:3.2
RUN apk add <span class="nt">--update</span> ca-certificates <span class="c"># Certificates for SSL</span>
ADD tmp/someexecutable /go/bin/someexecutable
ENTRYPOINT /go/bin/someexecutable</code></pre></figure>

<p>Compare this to my original 500MB image built from the <a href="https://github.com/docker-library/golang">golang base image</a>:</p>

<h4 id="dockerfile-2">Dockerfile</h4>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Start from a Debian image with the latest version of Go installed</span>
<span class="c"># and a workspace (GOPATH) configured at /go.</span>
FROM golang <span class="c"># This line alone will put you at about 300MB.</span>

<span class="c"># Copy the local package files to the container's workspace.</span>
ADD <span class="nb">.</span> /go/src/github.com/dimroc/urbanevents/cityservice

<span class="c"># Build the outyet command inside the container.</span>
<span class="c"># (You may fetch or manage dependencies here,</span>
<span class="c"># either manually or with a tool like "godep".)</span>

WORKDIR /go/src/github.com/dimroc/urbanevents/cityservice

RUN wget https://raw.githubusercontent.com/pote/gpm/v1.3.2/bin/gpm <span class="o">&amp;&amp;</span> <span class="se">\</span>
      <span class="nb">chmod</span> +x gpm <span class="o">&amp;&amp;</span> <span class="se">\</span>
      <span class="nb">mv </span>gpm /usr/local/bin <span class="c"># GPM</span>

RUN gpm
RUN go <span class="nb">install </span>github.com/dimroc/urbanevents/cityservice/cityrecorder
WORKDIR /go/src/github.com/dimroc/urbanevents/cityservice/cityrecorder
ENTRYPOINT /go/bin/cityrecorder</code></pre></figure>

<p>With the new minimalist Dockerfile, pushing incremental changes only sends
a trivial 11MB and the image is now a reasonable 40MB. A far cry from the hundred MB sized docker
images floating around.</p>

<p>Cross Compiled Go + Alpine Linux + Docker = Win</p>
-->
      <!--<a class="more" href="/2015/08/20/cross-compiled-go-with-docker/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/08/19/where-tech-companies-fall-in-the-marketing-funnel/">
        Where Tech Companies Fall in the Purchase Funnel
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/08/19/where-tech-companies-fall-in-the-marketing-funnel/#disqus_thread"></a></span>
    <span class="post-date">19 Aug 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>I‚Äôm talking to a bunch of sales guys and they start to mention how
the big boys in tech (google search, facebook, yahoo, youtube, twitter, etc) all control varying
amounts of marketing dollars in the <a href="https://en.wikipedia.org/wiki/Purchase_funnel">Purchase Funnel</a>.</p>

<p>The what?</p>

<p>You know, AIDA:</p>

<p><img src="/public/images/aida-funnel1.gif" alt="AIDA Marketing Funnel" /></p>

<p>Dropped right after <strong>ABC</strong> (Always Be Closing) in
<a href="http://www.imdb.com/title/tt0104348/">Glengarry Glen Ross</a>, AIDA is a very popular acronym used in marketing to describe to Purchase Funnel.</p>

<iframe width="420" height="315" src="https://www.youtube.com/embed/SOrsThlgGxc" frameborder="0" allowfullscreen=""></iframe>

<h4 id="wikipedia">Wikipedia:</h4>

<blockquote>
  <p>The purchase funnel, or purchasing funnel, is a consumer focused marketing model which
illustrates the theoretical customer journey towards the purchase of a product or service.</p>
</blockquote>

<p>All companies go <strong>across the funnel</strong> to some
degree. But from a consumer perspective, some have more sway than others.</p>

<blockquote>
  <p>Eg. ‚ÄúGeneric search‚Äù on Google (searching for ‚Äúvacation ideas‚Äù) is upper funnel and in
the <strong>awareness/interest</strong> stage. While a search term that is showing intent to purchase, eg. ‚Äúnetflix coupon code‚Äù, is at the bottom in <strong>action</strong>.</p>
</blockquote>

<p>I‚Äôve gone ahead and placed the tech companies where I think they have the most mind share
for that particular stage of the funnel.</p>

<p><img src="/public/images/aida-companies.jpg" alt="AIDA Companies" /></p>

<h3 id="ad-exchange-works-across-all-parts">Ad Exchange works across all parts</h3>

<p>FB &amp; Google both have their own ‚ÄúAd Exchange‚Äù platforms that run all the way up from upper funnel brand to lower funnel, algorithmic, ‚Äúdirect response‚Äù ad solutions.</p>

<h3 id="personal-takeaways">Personal Takeaways</h3>

<ul>
  <li>Social Media raises Awareness.</li>
  <li>I don‚Äôt know what to do about Interest.</li>
  <li>Search shows desire.</li>
  <li>Action is usually the marketplace that allows a purchase to happen. Although, I‚Äôm being told this is where Google Search is positioned.</li>
</ul>

<p>Apparently, there is a simplified model that collapses Interest into Desire, and is called <strong>CAB</strong>:</p>

<ul>
  <li>Cognition (Awareness or learning)</li>
  <li>Affect (Feeling, interest or desire)</li>
  <li>Behavior (Action)</li>
</ul>

<p>But we‚Äôre going to stick with the classic.</p>

<h3 id="still-to-do">Still to do</h3>

<ul>
  <li>Retention Loop: We‚Äôll save this for another post.</li>
</ul>
-->
      <!--<a class="more" href="/2015/08/19/where-tech-companies-fall-in-the-marketing-funnel/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/08/03/visualizing-tweets-with-kibana-4/">
        Charting Tweets with Kibana 4 and CloudWatch
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/08/03/visualizing-tweets-with-kibana-4/#disqus_thread"></a></span>
    <span class="post-date">03 Aug 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>A lot of people have a lot of data in their Elasticsearch clusters. We have all the geotagged tweets
coming out of cities for the past few months. Extracting any additional insight is a big win,
and this is where <a href="https://www.elastic.co/products/kibana">Kibana</a> comes in.</p>

<p><img src="/public/images/KibanaForTweets.png" alt="Kibana For Tweets" /></p>

<p>My city tweets are pretty noisy at the moment. I‚Äôll check back in when I‚Äôve sliced out something meaningful.</p>

<p>In the mean-time, I‚Äôve been tracking the tweet frequency of certain cities via Amazon‚Äôs <a href="http://aws.amazon.com/cloudwatch/">CloudWatch</a>.
Mostly so <a href="http://aws.amazon.com/sns/">SNS</a> can send me a text when things go quiet, but it makes for a decent time-series chart:</p>

<p><img src="/public/images/CloudWatchForTweets.png" alt="CloudWatch For Tweets" /></p>

<p>Three takeaways here:</p>

<ul>
  <li>The day night cycles present an obvious pattern, although it never truly goes quiet.</li>
  <li>NYC and LA have a dramatically higher volume than the other cities, which makes sense given their size.</li>
  <li>Parisians have better things to do than tweet.</li>
</ul>
-->
      <!--<a class="more" href="/2015/08/03/visualizing-tweets-with-kibana-4/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/05/16/experimenting-with-cartodb/">
        Experimenting with Twitter Data in CartoDB
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/05/16/experimenting-with-cartodb/#disqus_thread"></a></span>
    <span class="post-date">16 May 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>Lately, I‚Äôve been experimenting with a variety of mapping solutions. Starting with the barebones Leaflet (amazing), and then taking things a step
further with CartoDB. I‚Äôve got all these tweets lying around from <a href="http://www.newtweetcity.com">New Tweet City</a>, so I figured I would put them to good use.</p>

<p>I was just in California, and people were all about <a href="http://www.coachella.com">Coachella</a>.
On my return home I asked myself, ‚ÄúWhich NYC neighborhoods actually care about Coachella?‚Äù I made the intensity map below to answer this question:</p>

<iframe width="100%" height="520" frameborder="0" src="https://dimroc.cartodb.com/viz/d2c4ff4e-fc9b-11e4-8e56-0e018d66dc29/embed_map" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" oallowfullscreen="" msallowfullscreen=""></iframe>

<p>The neighborhoods of FiDi and TriBeCa took that crown, to no surprise. They are some of the most affluent neighborhoods in NYC and I can see those residents hyping up Coachella.
Meanwhile, Washington Heights and northern Manhattan had little if any activity.</p>

<p>Below, you can clearly see how interest in <a href="http://www.coachella.com">Coachella</a> spikes in the month of April, when the event occurs:</p>
<iframe width="100%" height="520" frameborder="0" src="https://dimroc.cartodb.com/viz/4acec984-fc9c-11e4-a15a-0e0c41326911/embed_map" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" oallowfullscreen="" msallowfullscreen=""></iframe>

<p>Over the next few months, I‚Äôll be plotting some more NYC data to glean insight into particular neighborhoods.</p>
-->
      <!--<a class="more" href="/2015/05/16/experimenting-with-cartodb/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/05/07/etl-language-showdown-pt2/">
        Comparing Golang, Scala, Elixir, Ruby, and now Python3 for ETL: Part 2
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/05/07/etl-language-showdown-pt2/#disqus_thread"></a></span>
    <span class="post-date">07 May 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>A year ago, I wrote the same program in four languages to compare their productivity when performing <a href="https://en.wikipedia.org/wiki/Extract,_transform,_load">ETL (extract-transform-load)</a>.
Read about <a href="/2014/09/29/etl-language-showdown/">part 1 here</a> and feel free to check out the <a href="https://github.com/dimroc/etl-language-comparison">source code</a>.</p>

<p>The code has changed, the languages have evolved, and the hardware now includes a SSD drive. So, where are they now?</p>

<p><em>Update: There is now also a <a href="/2015/11/14/etl-language-showdown-pt3/">part 3</a></em></p>
-->
      <!--<a class="more" href="/2015/05/07/etl-language-showdown-pt2/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/04/20/amazon-lambda-for-autoscaling-work/">
        Amazon Lambda to Autoscale Background Work
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/04/20/amazon-lambda-for-autoscaling-work/#disqus_thread"></a></span>
    <span class="post-date">20 Apr 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>Many hours have been spent optimizing the cost background work. <a href="http://www.iron.io/">Iron.io</a> has Iron Worker that scales up when a job is submitted,
<a href="https://www.hirefire.io/">HireFire</a> spins up and down Heroku Dynos and AWS has Autoscale groups for EC2 instances.</p>

<p>Now <a href="http://aws.amazon.com/lambda/">Amazon Lambda‚Äôs</a> joining the party. Only supporting node.js for the time being, this service magically autoscales
based on size of whatever queue is feeding it. It responds to a new entry into an empty queue within milliseconds and is
extremely cost efficient.</p>

<p>A part of me feels for the hundreds of companies that rolled out their own scalable backend only to see this deprecate all that work overnight.
I would know, I worked on one.</p>
-->
      <!--<a class="more" href="/2015/04/20/amazon-lambda-for-autoscaling-work/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/01/30/heroku-announces-ability-to-share-addons/">
        Heroku announces ability to share apps as add ons
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/01/30/heroku-announces-ability-to-share-addons/#disqus_thread"></a></span>
    <span class="post-date">30 Jan 2015</span>

    <!--<div class="custom summary">-->
      <!--<p>Everytime I think I‚Äôm going to move off of Heroku for some fancy <a href="https://www.docker.com/">Docker</a>
setup, they announce something that pulls me back.</p>

<p>First it was the <a href="https://blog.heroku.com/archives/2014/8/5/new-dashboard-and-metrics-beta">metrics dashboard</a> and now it‚Äôs the
<a href="https://blog.heroku.com/archives/2015/1/23/expanding_the_power_of_add_ons">ability to share add ons across apps</a>.</p>

<p>This allows one to share a service between their own personal apps, easing the transition to a microservice architecture. All
with great metrics of course.</p>

<p>Well done.</p>
-->
      <!--<a class="more" href="/2015/01/30/heroku-announces-ability-to-share-addons/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2015/01/08/centralized-logging-of-iphone-with-papertrail/">
        Centralized Logging of iPhone apps with Papertrail
      </a>
    </h3>

    <span class="post-comments"><a href="/2015/01/08/centralized-logging-of-iphone-with-papertrail/#disqus_thread"></a></span>
    <span class="post-date">08 Jan 2015</span>

    <!--<div class="custom summary">-->
      <!--<p><img src="/public/images/PapertrailForIPhone.png" alt="Papertrail for iPhone" /></p>

<p>I use <a href="https://papertrailapp.com/">Papertrail</a> for all my server logging needs, and love it. I‚Äôm almost always bullish on the use of third party
services to offload work from a product dev team. Not too many people want to spend time working on log drains, me included.</p>

<p>When doing iPhone development, working with logs outside of XCode is clumsy at best and usually nonexistent. And when your beta is in the wild, that‚Äôs not even an option
because you‚Äôre unable to round up all your testers‚Äô devices.</p>

<p>Don‚Äôt worry, I‚Äôm here to tell you your iOS app can be configured to automatically upload logs to <a href="http://help.papertrailapp.com/kb/configuration/configuring-centralized-logging-from-ios-or-os-x-apps/">Papertrail</a>
as described <a href="http://help.papertrailapp.com/kb/configuration/configuring-centralized-logging-from-ios-or-os-x-apps/">here</a> within 15 minutes.</p>

-->
      <!--<a class="more" href="/2015/01/08/centralized-logging-of-iphone-with-papertrail/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/12/17/bolt-framework-promisekit-or-reactive-cocoa-for-async/">
        Taming Callbacks in iOS: Bolts Framework
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/12/17/bolt-framework-promisekit-or-reactive-cocoa-for-async/#disqus_thread"></a></span>
    <span class="post-date">17 Dec 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>Managing many asynchronous events in iOS can get hairy, but it‚Äôs a fact of life when working with
remote services. So how do we avoid callback hell?</p>

<p><strong>Promises</strong>.</p>

<p>Below I‚Äôll explain why I chose the <a href="https://github.com/BoltsFramework/Bolts-iOS"><strong>Bolts Framework (BF)</strong></a>
over <a href="https://github.com/mxcl/PromiseKit">PromiseKit</a> and <a href="https://github.com/ReactiveCocoa/ReactiveCocoa">ReactiveCocoa</a>.</p>

-->
      <!--<a class="more" href="/2014/12/17/bolt-framework-promisekit-or-reactive-cocoa-for-async/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/12/11/migrating-data-separate-from-the-schema/">
        Not All Migrations are Equal: Schema vs. Data
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/12/11/migrating-data-separate-from-the-schema/#disqus_thread"></a></span>
    <span class="post-date">11 Dec 2014</span>

    <!--<div class="custom summary">-->
      <!--<p><em>Update 01/26/2015: Check out the <a href="https://github.com/jasonfb/nondestructive_migrations">nondestructive_migrations</a> gem. It‚Äôs similar to dimroc/datafix but simpler because it
leverages existing AR code. It does not however generate specs‚Ä¶ yet.</em></p>

<hr />

<p>You‚Äôve been using <a href="http://api.rubyonrails.org/classes/ActiveRecord/Migration.html">Active Record Migrations</a> to manage changes in
your database and you love it. But then a model‚Äôs validations change, and all your existing data becomes invalid.</p>

<p>What do you do? Place it in an AR migration? Depends. Those are primarily for <strong>schema migrations</strong> and this is not a schema change.</p>

<p>You need to run a <strong>data migration</strong>.</p>

-->
      <!--<a class="more" href="/2014/12/11/migrating-data-separate-from-the-schema/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/11/12/eager-pagination-with-elasticsearch-rails/">
        Eager Pagination with Elasticsearch-rails
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/11/12/eager-pagination-with-elasticsearch-rails/#disqus_thread"></a></span>
    <span class="post-date">12 Nov 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>So you‚Äôre searching millions of records with <a href="https://github.com/elasticsearch/elasticsearch-rails/tree/master/elasticsearch-model">Elasticsearch-model</a>
but want to eagerly load all associations when rendering your page for performance reasons. But wait, you‚Äôre using <a href="https://github.com/amatsuda/kaminari">Kaminari</a> for pagination,
and when you <code class="language-plaintext highlighter-rouge">includes(:association)</code>, you lose the pagination support.</p>

<p>Below, you‚Äôll see how a simple delegator will relieve your woes and eagerly load associations with support for pagination.</p>

-->
      <!--<a class="more" href="/2014/11/12/eager-pagination-with-elasticsearch-rails/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/10/29/arelastic-for-building-your-es-queries/">
        Arelastic for your Elasticsearch Queries pt.1
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/10/29/arelastic-for-building-your-es-queries/#disqus_thread"></a></span>
    <span class="post-date">29 Oct 2014</span>

    <!--<div class="custom summary">-->
      <!--<p><em>Update 08/2015: <a href="https://github.com/elastic/elasticsearch-ruby/tree/master/elasticsearch-dsl">Elasticsearch-ruby has its own DSL</a>.
It‚Äôs officially supported by Elasticsearch so be sure to check it out.</em></p>

<p>When doing more than just a simple search with <a href="https://github.com/elasticsearch/elasticsearch-rails/tree/master/elasticsearch-model">Elasticsearch-rails</a>,
a naive approach will lead you to this mess:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">response</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">search</span> <span class="ss">query:     </span><span class="p">{</span> <span class="ss">match:  </span><span class="p">{</span> <span class="ss">title: </span><span class="s2">"Fox Dogs"</span> <span class="p">}</span> <span class="p">},</span>
                          <span class="ss">highlight: </span><span class="p">{</span> <span class="ss">fields: </span><span class="p">{</span> <span class="ss">title: </span><span class="p">{}</span> <span class="p">}</span> <span class="p">}</span></code></pre></figure>

<p>Don‚Äôt be a sucker! Read on to see how <a href="https://github.com/matthuhiggins/arelastic">Arelastic</a> can save you pain.</p>

-->
      <!--<a class="more" href="/2014/10/29/arelastic-for-building-your-es-queries/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/10/23/pundit-for-roles/">
        Pundit for Roles on Rails
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/10/23/pundit-for-roles/#disqus_thread"></a></span>
    <span class="post-date">23 Oct 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>Roles are almost always a requirement for a web app. There are many good options out there for Rails, with the old guard being <a href="https://github.com/CanCanCommunity/cancancan">CanCan</a>
and <a href="https://github.com/RolifyCommunity/rolify">Rolify</a>. But then I met this newcomer, <a href="https://github.com/elabs/pundit">Pundit</a>, and its
simplicity stole the show.</p>

-->
      <!--<a class="more" href="/2014/10/23/pundit-for-roles/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/30/toggleable-fakes/">
        Toggleable Fakes for better integration testing
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/30/toggleable-fakes/#disqus_thread"></a></span>
    <span class="post-date">30 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>During the development of <a href="https://github.com/dimroc/iOS.ProjectMonitor">iOS Project Monitor</a>, I ran into the need
to test against a few third party services. Engineyard‚Äôs Andy Delcambre gave a great talk on how to use test matrices and fake services
to write one test that hits both your fake and the service.</p>

-->
      <!--<a class="more" href="/2014/09/30/toggleable-fakes/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/30/error-handling-in-swift/">
        A better error handling future for iOS with Swift
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/30/error-handling-in-swift/#disqus_thread"></a></span>
    <span class="post-date">30 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p><em>Update: I now handle errors from callbacks with the <a href="http://www.dimroc.com/2014/12/17/bolt-framework-promisekit-or-reactive-cocoa-for-async/">Bolts Framework</a>. Consider this article deprecated.</em></p>

<hr />

<p>Pattern matching is a fantastic mechanism found in functional programming languages, and <a href="https://developer.apple.com/swift/">Swift</a> has it! Below, we‚Äôll find out how to use it to encapsulate errors in asynchronous code.</p>

-->
      <!--<a class="more" href="/2014/09/30/error-handling-in-swift/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/29/etl-language-showdown/">
        Comparing Golang, Scala, Elixir and Ruby for ETL
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/29/etl-language-showdown/#disqus_thread"></a></span>
    <span class="post-date">29 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p><em>Update 05/11/2015: After reading this, check out <a href="/2015/05/07/etl-language-showdown-pt2/">part 2</a> to
see how updates to the younger languages (Elixir, Golang) and changes to the algorithm (no intermediary reduction file) affected results.</em></p>

<h2 id="update-there-is-now-a-part-3"><em>Update: There is now a <a href="/2015/11/14/etl-language-showdown-pt3/">part 3</a></em></h2>

<p>How do the following languages stack up when running an <a href="https://en.wikipedia.org/wiki/Extract,_transform,_load">extract, transform, and load (ETL)</a> against ~40M tweets? Read on to find out more.</p>

<ul>
  <li><a href="https://www.ruby-lang.org/en/news/2013/12/25/ruby-2-1-0-is-released/">Ruby, JRuby, and Parallel</a></li>
  <li><a href="http://golang.org/">Golang 1.2</a> - Imperative</li>
  <li><a href="http://scala-lang.org/">Scala 2.10.4</a> - Both Imperative and Functional</li>
  <li><a href="http://elixir-lang.org/">Elixir 0.13.0</a> - Functional</li>
</ul>

-->
      <!--<a class="more" href="/2014/09/29/etl-language-showdown/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/28/elasticsearch-nginx/">
        Elasticsearch behind NGINX on AWS
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/28/elasticsearch-nginx/#disqus_thread"></a></span>
    <span class="post-date">28 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>Hosting on Heroku or any other multi-tenant PaaS means you‚Äôre sharing IP security with other people. Now your web services require at least basic auth
when interacting with services like MySQL and Elasticsearch. We will run Elasticsearch behind nginx, which will enforce a username/pw for basic auth.</p>

-->
      <!--<a class="more" href="/2014/09/28/elasticsearch-nginx/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/27/ios-project-monitor/">
        Monitoring CI from your iPhone
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/27/ios-project-monitor/#disqus_thread"></a></span>
    <span class="post-date">27 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>Ever want to receive a push notification when a commit fails CI? Well, do I have news for you.</p>

-->
      <!--<a class="more" href="/2014/09/27/ios-project-monitor/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/26/nyc-building-perimeters/">
        NYC Building Perimeters
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/26/nyc-building-perimeters/#disqus_thread"></a></span>
    <span class="post-date">26 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>I love NYC and WebGL. So I married the two by rendering NYC building perimeters with <a href="http://threejs.org/">ThreeJS</a> using <a href="https://nycopendata.socrata.com/">NYC Open Data</a>.</p>

-->
      <!--<a class="more" href="/2014/09/26/nyc-building-perimeters/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/25/hood-frequency/">
        NYC Neighborhood Term Frequency
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/25/hood-frequency/#disqus_thread"></a></span>
    <span class="post-date">25 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>Which New York neighborhoods care the most about startups? Aggregating across ~50M tweets with Elasticsearch looking for the term <em>startups</em> gave me an answer.</p>

-->
      <!--<a class="more" href="/2014/09/25/hood-frequency/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/09/24/tweets-as-pixels/">
        Tweets as Pixels in NYC
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/09/24/tweets-as-pixels/#disqus_thread"></a></span>
    <span class="post-date">24 Sep 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>What do you get when you brighten a pixel every time you get a tweet‚Äôs location? That‚Äôs what <a href="https://blog.twitter.com/2013/the-geography-of-tweets">Miguel Rios</a> asked
in his post <a href="https://blog.twitter.com/2013/the-geography-of-tweets">The Geography of Tweets</a>.</p>

-->
      <!--<a class="more" href="/2014/09/24/tweets-as-pixels/">Read More</a>-->
    <!--</div>-->
  </div>
  
  <div class="post">
    <h3 class="custom post-title">
      <a href="/2014/08/20/intro-to-threejs-slides/">
        Intro to ThreeJS... using ThreeJS
      </a>
    </h3>

    <span class="post-comments"><a href="/2014/08/20/intro-to-threejs-slides/#disqus_thread"></a></span>
    <span class="post-date">20 Aug 2014</span>

    <!--<div class="custom summary">-->
      <!--<p>I‚Äôm a big believer in learning by doing. So when I set out to learn ThreeJS, I did it by making <a href="http://www.dimroc.com/reveal.js-threejs/">this sweet slide deck</a>.
Click through to check out details.</p>

-->
      <!--<a class="more" href="/2014/08/20/intro-to-threejs-slides/">Read More</a>-->
    <!--</div>-->
  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'dimroc'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>


  </body>
</html>
